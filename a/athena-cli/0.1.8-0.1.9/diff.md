# Comparing `tmp/athena-cli-0.1.8.tar.gz` & `tmp/athena-cli-0.1.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/athena-cli-0.1.8.tar", last modified: Mon Feb 12 09:41:32 2018, max compression
+gzip compressed data, was "dist/athena-cli-0.1.9.tar", last modified: Fri May 10 17:12:31 2019, max compression
```

## Comparing `athena-cli-0.1.8.tar` & `athena-cli-0.1.9.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -1,17 +1,17 @@
-00000000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00000000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00000010: 2f00 0000 0000 0000 0000 0000 0000 0000  /...............
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
 00000070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000080: 3030 3030 3030 3000 3133 3234 3032 3630  0000000.13240260
-00000090: 3531 3400 3031 3435 3031 0020 3500 0000  514.014501. 5...
+00000080: 3030 3030 3030 3000 3133 3436 3533 3330  0000000.13465330
+00000090: 3337 3700 3031 3435 3230 0020 3500 0000  377.014520. 5...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -26,24 +26,24 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00000200: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00000210: 2f50 4b47 2d49 4e46 4f00 0000 0000 0000  /PKG-INFO.......
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00000270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000280: 3030 3030 3532 3400 3133 3234 3032 3630  0000524.13240260
-00000290: 3531 3400 3031 3535 3737 0020 3000 0000  514.015577. 0...
+00000280: 3030 3030 3534 3500 3133 3436 3533 3330  0000545.13465330
+00000290: 3337 3700 3031 3536 3231 0020 3000 0000  377.015621. 0...
 000002a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000002b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000002c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000002d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000002e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000002f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000300: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -59,55 +59,55 @@
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000400: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00000410: 3a20 312e 310a 4e61 6d65 3a20 6174 6865  : 1.1.Name: athe
+00000410: 3a20 312e 320a 4e61 6d65 3a20 6174 6865  : 1.2.Name: athe
 00000420: 6e61 2d63 6c69 0a56 6572 7369 6f6e 3a20  na-cli.Version: 
-00000430: 302e 312e 380a 5375 6d6d 6172 793a 2050  0.1.8.Summary: P
+00000430: 302e 312e 390a 5375 6d6d 6172 793a 2050  0.1.9.Summary: P
 00000440: 7265 7374 6f2d 6c69 6b65 2043 4c49 2066  resto-like CLI f
 00000450: 6f72 2041 5753 2041 7468 656e 610a 486f  or AWS Athena.Ho
 00000460: 6d65 2d70 6167 653a 2068 7474 7073 3a2f  me-page: https:/
-00000470: 2f67 6974 6875 622e 636f 6d2f 6775 6172  /github.com/guar
-00000480: 6469 616e 2f61 7468 656e 612d 636c 690a  dian/athena-cli.
+00000470: 2f67 6974 6875 622e 636f 6d2f 7361 7474  /github.com/satt
+00000480: 6572 6c79 2f61 7468 656e 612d 636c 690a  erly/athena-cli.
 00000490: 4175 7468 6f72 3a20 4e69 636b 2053 6174  Author: Nick Sat
 000004a0: 7465 726c 790a 4175 7468 6f72 2d65 6d61  terly.Author-ema
 000004b0: 696c 3a20 6e69 636b 2e73 6174 7465 726c  il: nick.satterl
-000004c0: 7940 7468 6567 7561 7264 6961 6e2e 636f  y@theguardian.co
-000004d0: 6d0a 4c69 6365 6e73 653a 2041 7061 6368  m.License: Apach
-000004e0: 6520 4c69 6365 6e73 6520 322e 300a 4465  e License 2.0.De
-000004f0: 7363 7269 7074 696f 6e3a 2055 4e4b 4e4f  scription: UNKNO
-00000500: 574e 0a4b 6579 776f 7264 733a 2061 7773  WN.Keywords: aws
-00000510: 2061 7468 656e 6120 7072 6573 746f 2063   athena presto c
-00000520: 6c69 0a50 6c61 7466 6f72 6d3a 2055 4e4b  li.Platform: UNK
-00000530: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
-00000540: 2054 6f70 6963 203a 3a20 5574 696c 6974   Topic :: Utilit
-00000550: 6965 730a 0000 0000 0000 0000 0000 0000  ies.............
-00000560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000004c0: 7940 676d 6169 6c2e 636f 6d0a 4c69 6365  y@gmail.com.Lice
+000004d0: 6e73 653a 2041 7061 6368 6520 4c69 6365  nse: Apache Lice
+000004e0: 6e73 6520 322e 300a 4465 7363 7269 7074  nse 2.0.Descript
+000004f0: 696f 6e3a 2055 4e4b 4e4f 574e 0a4b 6579  ion: UNKNOWN.Key
+00000500: 776f 7264 733a 2061 7773 2061 7468 656e  words: aws athen
+00000510: 6120 7072 6573 746f 2063 6c69 0a50 6c61  a presto cli.Pla
+00000520: 7466 6f72 6d3a 2055 4e4b 4e4f 574e 0a43  tform: UNKNOWN.C
+00000530: 6c61 7373 6966 6965 723a 2054 6f70 6963  lassifier: Topic
+00000540: 203a 3a20 5574 696c 6974 6965 730a 5265   :: Utilities.Re
+00000550: 7175 6972 6573 2d50 7974 686f 6e3a 203e  quires-Python: >
+00000560: 3d33 2e35 0a00 0000 0000 0000 0000 0000  =3.5............
 00000570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000600: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00000600: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00000610: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00000620: 696e 666f 2f00 0000 0000 0000 0000 0000  info/...........
 00000630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000660: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
 00000670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000680: 3030 3030 3030 3000 3133 3234 3032 3630  0000000.13240260
-00000690: 3531 3400 3032 3032 3632 0020 3500 0000  514.020262. 5...
+00000680: 3030 3030 3030 3000 3133 3436 3533 3330  0000000.13465330
+00000690: 3337 3700 3032 3033 3031 0020 3500 0000  377.020301. 5...
 000006a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000700: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -122,24 +122,24 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00000800: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00000810: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00000820: 696e 666f 2f50 4b47 2d49 4e46 4f00 0000  info/PKG-INFO...
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00000870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000880: 3030 3030 3532 3400 3133 3234 3032 3630  0000524.13240260
-00000890: 3531 3400 3032 3133 3630 0020 3000 0000  514.021360. 0...
+00000880: 3030 3030 3534 3500 3133 3436 3533 3330  0000545.13465330
+00000890: 3337 3700 3032 3134 3032 0020 3000 0000  377.021402. 0...
 000008a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000008b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000008c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000008d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000008e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000008f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000900: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -155,55 +155,55 @@
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00000a10: 3a20 312e 310a 4e61 6d65 3a20 6174 6865  : 1.1.Name: athe
+00000a10: 3a20 312e 320a 4e61 6d65 3a20 6174 6865  : 1.2.Name: athe
 00000a20: 6e61 2d63 6c69 0a56 6572 7369 6f6e 3a20  na-cli.Version: 
-00000a30: 302e 312e 380a 5375 6d6d 6172 793a 2050  0.1.8.Summary: P
+00000a30: 302e 312e 390a 5375 6d6d 6172 793a 2050  0.1.9.Summary: P
 00000a40: 7265 7374 6f2d 6c69 6b65 2043 4c49 2066  resto-like CLI f
 00000a50: 6f72 2041 5753 2041 7468 656e 610a 486f  or AWS Athena.Ho
 00000a60: 6d65 2d70 6167 653a 2068 7474 7073 3a2f  me-page: https:/
-00000a70: 2f67 6974 6875 622e 636f 6d2f 6775 6172  /github.com/guar
-00000a80: 6469 616e 2f61 7468 656e 612d 636c 690a  dian/athena-cli.
+00000a70: 2f67 6974 6875 622e 636f 6d2f 7361 7474  /github.com/satt
+00000a80: 6572 6c79 2f61 7468 656e 612d 636c 690a  erly/athena-cli.
 00000a90: 4175 7468 6f72 3a20 4e69 636b 2053 6174  Author: Nick Sat
 00000aa0: 7465 726c 790a 4175 7468 6f72 2d65 6d61  terly.Author-ema
 00000ab0: 696c 3a20 6e69 636b 2e73 6174 7465 726c  il: nick.satterl
-00000ac0: 7940 7468 6567 7561 7264 6961 6e2e 636f  y@theguardian.co
-00000ad0: 6d0a 4c69 6365 6e73 653a 2041 7061 6368  m.License: Apach
-00000ae0: 6520 4c69 6365 6e73 6520 322e 300a 4465  e License 2.0.De
-00000af0: 7363 7269 7074 696f 6e3a 2055 4e4b 4e4f  scription: UNKNO
-00000b00: 574e 0a4b 6579 776f 7264 733a 2061 7773  WN.Keywords: aws
-00000b10: 2061 7468 656e 6120 7072 6573 746f 2063   athena presto c
-00000b20: 6c69 0a50 6c61 7466 6f72 6d3a 2055 4e4b  li.Platform: UNK
-00000b30: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
-00000b40: 2054 6f70 6963 203a 3a20 5574 696c 6974   Topic :: Utilit
-00000b50: 6965 730a 0000 0000 0000 0000 0000 0000  ies.............
-00000b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00000ac0: 7940 676d 6169 6c2e 636f 6d0a 4c69 6365  y@gmail.com.Lice
+00000ad0: 6e73 653a 2041 7061 6368 6520 4c69 6365  nse: Apache Lice
+00000ae0: 6e73 6520 322e 300a 4465 7363 7269 7074  nse 2.0.Descript
+00000af0: 696f 6e3a 2055 4e4b 4e4f 574e 0a4b 6579  ion: UNKNOWN.Key
+00000b00: 776f 7264 733a 2061 7773 2061 7468 656e  words: aws athen
+00000b10: 6120 7072 6573 746f 2063 6c69 0a50 6c61  a presto cli.Pla
+00000b20: 7466 6f72 6d3a 2055 4e4b 4e4f 574e 0a43  tform: UNKNOWN.C
+00000b30: 6c61 7373 6966 6965 723a 2054 6f70 6963  lassifier: Topic
+00000b40: 203a 3a20 5574 696c 6974 6965 730a 5265   :: Utilities.Re
+00000b50: 7175 6972 6573 2d50 7974 686f 6e3a 203e  quires-Python: >
+00000b60: 3d33 2e35 0a00 0000 0000 0000 0000 0000  =3.5............
 00000b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000c00: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00000c00: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00000c10: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00000c20: 696e 666f 2f7a 6970 2d73 6166 6500 0000  info/zip-safe...
 00000c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00000c70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000c80: 3030 3030 3030 3100 3133 3136 3532 3633  0000001.13165263
-00000c90: 3530 3600 3032 3137 3234 0020 3000 0000  506.021724. 0...
+00000c80: 3030 3030 3030 3100 3133 3436 3532 3537  0000001.13465257
+00000c90: 3435 3000 3032 3137 3331 0020 3000 0000  450.021731. 0...
 00000ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000d00: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -250,24 +250,24 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00001000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00001010: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00001020: 696e 666f 2f53 4f55 5243 4553 2e74 7874  info/SOURCES.txt
 00001030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00001080: 3030 3030 3432 3500 3133 3234 3032 3630  0000425.13240260
-00001090: 3531 3400 3032 3231 3437 0020 3000 0000  514.022147. 0...
+00001080: 3030 3030 3432 3500 3133 3436 3533 3330  0000425.13465330
+00001090: 3337 3700 3032 3231 3636 0020 3000 0000  377.022166. 0...
 000010a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001100: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -314,24 +314,24 @@
 00001390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001400: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00001400: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00001410: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00001420: 696e 666f 2f65 6e74 7279 5f70 6f69 6e74  info/entry_point
 00001430: 732e 7478 7400 0000 0000 0000 0000 0000  s.txt...........
 00001440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00001480: 3030 3030 3035 3400 3133 3234 3032 3630  0000054.13240260
-00001490: 3531 3400 3032 3335 3537 0020 3000 0000  514.023557. 0...
+00001480: 3030 3030 3035 3400 3133 3436 3533 3330  0000054.13465330
+00001490: 3337 3700 3032 3335 3736 0020 3000 0000  377.023576. 0...
 000014a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000014b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000014c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000014d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000014e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000014f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001500: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -378,24 +378,24 @@
 00001790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001800: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00001800: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00001810: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00001820: 696e 666f 2f72 6571 7569 7265 732e 7478  info/requires.tx
 00001830: 7400 0000 0000 0000 0000 0000 0000 0000  t...............
 00001840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00001880: 3030 3030 3033 3300 3133 3234 3032 3630  0000033.13240260
-00001890: 3531 3400 3032 3236 3536 0020 3000 0000  514.022656. 0...
+00001880: 3030 3030 3035 3300 3133 3436 3533 3330  0000053.13465330
+00001890: 3337 3700 3032 3236 3737 0020 3000 0000  377.022677. 0...
 000018a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000018b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000018c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000018d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000018e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000018f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001900: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -410,17 +410,17 @@
 00001990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000019a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000019b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000019c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000019d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000019e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000019f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001a00: 626f 746f 330a 636d 6432 0a74 6162 756c  boto3.cmd2.tabul
-00001a10: 6174 653e 3d30 2e38 2e31 0a00 0000 0000  ate>=0.8.1......
-00001a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00001a00: 626f 746f 333e 3d31 2e34 2e34 0a63 6d64  boto3>=1.4.4.cmd
+00001a10: 323e 3d30 2e39 2e30 2e31 0a74 6162 756c  2>=0.9.0.1.tabul
+00001a20: 6174 653e 3d30 2e38 2e31 0a00 0000 0000  ate>=0.8.1......
 00001a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -442,24 +442,24 @@
 00001b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001c00: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00001c00: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00001c10: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00001c20: 696e 666f 2f74 6f70 5f6c 6576 656c 2e74  info/top_level.t
 00001c30: 7874 0000 0000 0000 0000 0000 0000 0000  xt..............
 00001c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001c70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00001c80: 3030 3030 3031 3300 3133 3234 3032 3630  0000013.13240260
-00001c90: 3531 3400 3032 3330 3036 0020 3000 0000  514.023006. 0...
+00001c80: 3030 3030 3031 3300 3133 3436 3533 3330  0000013.13465330
+00001c90: 3337 3700 3032 3330 3235 0020 3000 0000  377.023025. 0...
 00001ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001d00: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -506,24 +506,24 @@
 00001f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00002000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00002010: 2f61 7468 656e 615f 636c 692e 6567 672d  /athena_cli.egg-
 00002020: 696e 666f 2f64 6570 656e 6465 6e63 795f  info/dependency_
 00002030: 6c69 6e6b 732e 7478 7400 0000 0000 0000  links.txt.......
 00002040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00002070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00002080: 3030 3030 3030 3100 3133 3234 3032 3630  0000001.13240260
-00002090: 3531 3400 3032 3433 3330 0020 3000 0000  514.024330. 0...
+00002080: 3030 3030 3030 3100 3133 3436 3533 3330  0000001.13465330
+00002090: 3337 3700 3032 3433 3437 0020 3000 0000  377.024347. 0...
 000020a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000020b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000020c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000020d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000020e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000020f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002100: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -570,24 +570,24 @@
 00002390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000023a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000023b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000023c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000023d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000023e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000023f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002400: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00002400: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00002410: 2f61 7468 656e 615f 636c 692e 7079 0000  /athena_cli.py..
 00002420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002460: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
 00002470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00002480: 3030 3332 3731 3500 3133 3234 3032 3630  0032715.13240260
-00002490: 3330 3700 3031 3731 3535 0020 3000 0000  307.017155. 0...
+00002480: 3030 3332 3533 3200 3133 3436 3533 3030  0032532.13465300
+00002490: 3435 3700 3031 3731 3635 0020 3000 0000  457.017165. 0...
 000024a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002500: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -612,878 +612,878 @@
 00002630: 206a 736f 6e0a 696d 706f 7274 206f 730a   json.import os.
 00002640: 696d 706f 7274 2072 6561 646c 696e 650a  import readline.
 00002650: 696d 706f 7274 2073 7562 7072 6f63 6573  import subproces
 00002660: 730a 696d 706f 7274 2073 7973 0a69 6d70  s.import sys.imp
 00002670: 6f72 7420 7469 6d65 0a69 6d70 6f72 7420  ort time.import 
 00002680: 7575 6964 0a0a 696d 706f 7274 2062 6f74  uuid..import bot
 00002690: 6f33 0a69 6d70 6f72 7420 626f 746f 636f  o3.import botoco
-000026a0: 7265 0a69 6d70 6f72 7420 636d 6432 2061  re.import cmd2 a
-000026b0: 7320 636d 640a 6672 6f6d 2062 6f74 6f63  s cmd.from botoc
-000026c0: 6f72 652e 6578 6365 7074 696f 6e73 2069  ore.exceptions i
-000026d0: 6d70 6f72 7420 436c 6965 6e74 4572 726f  mport ClientErro
-000026e0: 722c 2050 6172 616d 5661 6c69 6461 7469  r, ParamValidati
-000026f0: 6f6e 4572 726f 720a 6672 6f6d 2074 6162  onError.from tab
-00002700: 756c 6174 6520 696d 706f 7274 2074 6162  ulate import tab
-00002710: 756c 6174 650a 0a4c 4553 5320 3d20 226c  ulate..LESS = "l
-00002720: 6573 7320 2d46 5852 536e 220a 4849 5354  ess -FXRSn".HIST
-00002730: 4f52 595f 4649 4c45 5f53 495a 4520 3d20  ORY_FILE_SIZE = 
-00002740: 3530 300a 0a5f 5f76 6572 7369 6f6e 5f5f  500..__version__
-00002750: 203d 2027 302e 312e 3827 0a0a 0a63 6c61   = '0.1.8'...cla
-00002760: 7373 2041 7468 656e 6142 6174 6368 286f  ss AthenaBatch(o
-00002770: 626a 6563 7429 3a0a 0a20 2020 2064 6566  bject):..    def
-00002780: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00002790: 6174 6865 6e61 2c20 6462 3d4e 6f6e 652c  athena, db=None,
-000027a0: 2066 6f72 6d61 743d 2743 5356 2729 3a0a   format='CSV'):.
-000027b0: 2020 2020 2020 2020 7365 6c66 2e61 7468          self.ath
-000027c0: 656e 6120 3d20 6174 6865 6e61 0a20 2020  ena = athena.   
-000027d0: 2020 2020 2073 656c 662e 6462 6e61 6d65       self.dbname
-000027e0: 203d 2064 620a 2020 2020 2020 2020 7365   = db.        se
-000027f0: 6c66 2e66 6f72 6d61 7420 3d20 666f 726d  lf.format = form
-00002800: 6174 0a0a 2020 2020 6465 6620 6578 6563  at..    def exec
-00002810: 7574 6528 7365 6c66 2c20 7374 6174 656d  ute(self, statem
-00002820: 656e 7429 3a0a 2020 2020 2020 2020 6578  ent):.        ex
-00002830: 6563 7574 696f 6e5f 6964 203d 2073 656c  ecution_id = sel
-00002840: 662e 6174 6865 6e61 2e73 7461 7274 5f71  f.athena.start_q
-00002850: 7565 7279 5f65 7865 6375 7469 6f6e 2873  uery_execution(s
-00002860: 656c 662e 6462 6e61 6d65 2c20 7374 6174  elf.dbname, stat
-00002870: 656d 656e 7429 0a20 2020 2020 2020 2069  ement).        i
-00002880: 6620 6e6f 7420 6578 6563 7574 696f 6e5f  f not execution_
-00002890: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
-000028a0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-000028b0: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-000028c0: 2020 2020 2020 2020 7374 6174 7320 3d20          stats = 
-000028d0: 7365 6c66 2e61 7468 656e 612e 6765 745f  self.athena.get_
-000028e0: 7175 6572 795f 6578 6563 7574 696f 6e28  query_execution(
-000028f0: 6578 6563 7574 696f 6e5f 6964 290a 2020  execution_id).  
-00002900: 2020 2020 2020 2020 2020 7374 6174 7573            status
-00002910: 203d 2073 7461 7473 5b27 5175 6572 7945   = stats['QueryE
-00002920: 7865 6375 7469 6f6e 275d 5b27 5374 6174  xecution']['Stat
-00002930: 7573 275d 5b27 5374 6174 6527 5d0a 2020  us']['State'].  
-00002940: 2020 2020 2020 2020 2020 6966 2073 7461            if sta
-00002950: 7475 7320 696e 205b 2753 5543 4345 4544  tus in ['SUCCEED
-00002960: 4544 272c 2027 4641 494c 4544 272c 2027  ED', 'FAILED', '
-00002970: 4341 4e43 454c 4c45 4427 5d3a 0a20 2020  CANCELLED']:.   
-00002980: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-00002990: 616b 0a20 2020 2020 2020 2020 2020 2074  ak.            t
-000029a0: 696d 652e 736c 6565 7028 302e 3229 2020  ime.sleep(0.2)  
-000029b0: 2320 3230 306d 730a 0a20 2020 2020 2020  # 200ms..       
-000029c0: 2069 6620 7374 6174 7573 203d 3d20 2753   if status == 'S
-000029d0: 5543 4345 4544 4544 273a 0a20 2020 2020  UCCEEDED':.     
-000029e0: 2020 2020 2020 2072 6573 756c 7473 203d         results =
-000029f0: 2073 656c 662e 6174 6865 6e61 2e67 6574   self.athena.get
-00002a00: 5f71 7565 7279 5f72 6573 756c 7473 2865  _query_results(e
-00002a10: 7865 6375 7469 6f6e 5f69 6429 0a20 2020  xecution_id).   
-00002a20: 2020 2020 2020 2020 2068 6561 6465 7273           headers
-00002a30: 203d 205b 685b 274e 616d 6527 5d2e 656e   = [h['Name'].en
-00002a40: 636f 6465 2822 7574 662d 3822 2920 666f  code("utf-8") fo
-00002a50: 7220 6820 696e 2072 6573 756c 7473 5b27  r h in results['
-00002a60: 5265 7375 6c74 5365 7427 5d5b 2752 6573  ResultSet']['Res
-00002a70: 756c 7453 6574 4d65 7461 6461 7461 275d  ultSetMetadata']
-00002a80: 5b27 436f 6c75 6d6e 496e 666f 275d 5d0a  ['ColumnInfo']].
-00002a90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00002aa0: 7365 6c66 2e66 6f72 6d61 7420 696e 205b  self.format in [
-00002ab0: 2743 5356 272c 2027 4353 565f 4845 4144  'CSV', 'CSV_HEAD
-00002ac0: 4552 275d 3a0a 2020 2020 2020 2020 2020  ER']:.          
-00002ad0: 2020 2020 2020 6373 765f 7772 6974 6572        csv_writer
-00002ae0: 203d 2063 7376 2e77 7269 7465 7228 7379   = csv.writer(sy
-00002af0: 732e 7374 646f 7574 2c20 7175 6f74 696e  s.stdout, quotin
-00002b00: 673d 6373 762e 5155 4f54 455f 414c 4c29  g=csv.QUOTE_ALL)
-00002b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002b20: 2069 6620 7365 6c66 2e66 6f72 6d61 7420   if self.format 
-00002b30: 3d3d 2027 4353 565f 4845 4144 4552 273a  == 'CSV_HEADER':
-00002b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002b50: 2020 2020 2063 7376 5f77 7269 7465 722e       csv_writer.
-00002b60: 7772 6974 6572 6f77 2868 6561 6465 7273  writerow(headers
-00002b70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00002b80: 2020 6373 765f 7772 6974 6572 2e77 7269    csv_writer.wri
-00002b90: 7465 726f 7773 285b 5b74 6578 742e 656e  terows([[text.en
-00002ba0: 636f 6465 2822 7574 662d 3822 2920 666f  code("utf-8") fo
-00002bb0: 7220 7465 7874 2069 6e20 726f 775d 2066  r text in row] f
-00002bc0: 6f72 2072 6f77 2069 6e20 7365 6c66 2e61  or row in self.a
-00002bd0: 7468 656e 612e 7969 656c 645f 726f 7773  thena.yield_rows
-00002be0: 2872 6573 756c 7473 2c20 6865 6164 6572  (results, header
-00002bf0: 7329 5d29 0a20 2020 2020 2020 2020 2020  s)]).           
-00002c00: 2065 6c69 6620 7365 6c66 2e66 6f72 6d61   elif self.forma
-00002c10: 7420 3d3d 2027 5453 5627 3a0a 2020 2020  t == 'TSV':.    
-00002c20: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00002c30: 7428 7461 6275 6c61 7465 285b 726f 7720  t(tabulate([row 
-00002c40: 666f 7220 726f 7720 696e 2073 656c 662e  for row in self.
-00002c50: 6174 6865 6e61 2e79 6965 6c64 5f72 6f77  athena.yield_row
-00002c60: 7328 7265 7375 6c74 732c 2068 6561 6465  s(results, heade
-00002c70: 7273 295d 2c20 7461 626c 6566 6d74 3d27  rs)], tablefmt='
-00002c80: 7473 7627 2929 0a20 2020 2020 2020 2020  tsv')).         
-00002c90: 2020 2065 6c69 6620 7365 6c66 2e66 6f72     elif self.for
-00002ca0: 6d61 7420 3d3d 2027 5453 565f 4845 4144  mat == 'TSV_HEAD
-00002cb0: 4552 273a 0a20 2020 2020 2020 2020 2020  ER':.           
-00002cc0: 2020 2020 2070 7269 6e74 2874 6162 756c       print(tabul
-00002cd0: 6174 6528 5b72 6f77 2066 6f72 2072 6f77  ate([row for row
-00002ce0: 2069 6e20 7365 6c66 2e61 7468 656e 612e   in self.athena.
-00002cf0: 7969 656c 645f 726f 7773 2872 6573 756c  yield_rows(resul
-00002d00: 7473 2c20 6865 6164 6572 7329 5d2c 2068  ts, headers)], h
-00002d10: 6561 6465 7273 3d68 6561 6465 7273 2c20  eaders=headers, 
-00002d20: 7461 626c 6566 6d74 3d27 7473 7627 2929  tablefmt='tsv'))
-00002d30: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00002d40: 6620 7365 6c66 2e66 6f72 6d61 7420 3d3d  f self.format ==
-00002d50: 2027 5645 5254 4943 414c 273a 0a20 2020   'VERTICAL':.   
-00002d60: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00002d70: 206e 756d 2c20 726f 7720 696e 2065 6e75   num, row in enu
-00002d80: 6d65 7261 7465 2873 656c 662e 6174 6865  merate(self.athe
-00002d90: 6e61 2e79 6965 6c64 5f72 6f77 7328 7265  na.yield_rows(re
-00002da0: 7375 6c74 732c 2068 6561 6465 7273 2929  sults, headers))
-00002db0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00002dc0: 2020 2020 2020 7072 696e 7428 272d 2d5b        print('--[
-00002dd0: 5245 434f 5244 207b 7d5d 2d2d 272e 666f  RECORD {}]--'.fo
-00002de0: 726d 6174 286e 756d 2b31 2929 0a20 2020  rmat(num+1)).   
-00002df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e00: 2070 7269 6e74 2874 6162 756c 6174 6528   print(tabulate(
-00002e10: 7a69 7028 2a5b 6865 6164 6572 732c 2072  zip(*[headers, r
-00002e20: 6f77 5d29 2c20 7461 626c 6566 6d74 3d27  ow]), tablefmt='
-00002e30: 7072 6573 746f 2729 290a 2020 2020 2020  presto')).      
-00002e40: 2020 2020 2020 656c 7365 3a20 2023 2041        else:  # A
-00002e50: 4c49 474e 4544 0a20 2020 2020 2020 2020  LIGNED.         
-00002e60: 2020 2020 2020 2070 7269 6e74 2874 6162         print(tab
-00002e70: 756c 6174 6528 5b78 2066 6f72 2078 2069  ulate([x for x i
-00002e80: 6e20 7365 6c66 2e61 7468 656e 612e 7969  n self.athena.yi
-00002e90: 656c 645f 726f 7773 2872 6573 756c 7473  eld_rows(results
-00002ea0: 2c20 6865 6164 6572 7329 5d2c 2068 6561  , headers)], hea
-00002eb0: 6465 7273 3d68 6561 6465 7273 2c20 7461  ders=headers, ta
-00002ec0: 626c 6566 6d74 3d27 7072 6573 746f 2729  blefmt='presto')
-00002ed0: 290a 0a20 2020 2020 2020 2069 6620 7374  )..        if st
-00002ee0: 6174 7573 203d 3d20 2746 4149 4c45 4427  atus == 'FAILED'
-00002ef0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00002f00: 696e 7428 7374 6174 735b 2751 7565 7279  int(stats['Query
-00002f10: 4578 6563 7574 696f 6e27 5d5b 2753 7461  Execution']['Sta
-00002f20: 7475 7327 5d5b 2753 7461 7465 4368 616e  tus']['StateChan
-00002f30: 6765 5265 6173 6f6e 275d 290a 0a74 7279  geReason'])..try
-00002f40: 3a0a 2020 2020 6465 6c20 636d 642e 436d  :.    del cmd.Cm
-00002f50: 642e 646f 5f73 686f 7720 2023 2022 7368  d.do_show  # "sh
-00002f60: 6f77 2220 6973 2061 6e20 4174 6865 6e61  ow" is an Athena
-00002f70: 2063 6f6d 6d61 6e64 0a65 7863 6570 7420   command.except 
-00002f80: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-00002f90: 2020 2020 2320 2273 686f 7722 2077 6173      # "show" was
-00002fa0: 2072 656d 6f76 6564 2066 726f 6d20 436d   removed from Cm
-00002fb0: 6432 2030 2e38 2e30 0a20 2020 2070 6173  d2 0.8.0.    pas
-00002fc0: 730a 0a0a 636c 6173 7320 4174 6865 6e61  s...class Athena
-00002fd0: 5368 656c 6c28 636d 642e 436d 642c 206f  Shell(cmd.Cmd, o
-00002fe0: 626a 6563 7429 3a0a 0a20 2020 206d 756c  bject):..    mul
-00002ff0: 7469 6c69 6e65 436f 6d6d 616e 6473 203d  tilineCommands =
-00003000: 205b 2757 4954 4827 2c20 2753 454c 4543   ['WITH', 'SELEC
-00003010: 5427 2c20 2741 4c54 4552 272c 2027 4352  T', 'ALTER', 'CR
-00003020: 4541 5445 272c 2027 4445 5343 5249 4245  EATE', 'DESCRIBE
-00003030: 272c 2027 4452 4f50 272c 2027 4d53 434b  ', 'DROP', 'MSCK
-00003040: 272c 2027 5348 4f57 272c 2027 5553 4527  ', 'SHOW', 'USE'
-00003050: 2c20 2756 414c 5545 5327 5d0a 2020 2020  , 'VALUES'].    
-00003060: 616c 6c6f 775f 636c 695f 6172 6773 203d  allow_cli_args =
-00003070: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
-00003080: 5f5f 696e 6974 5f5f 2873 656c 662c 2061  __init__(self, a
-00003090: 7468 656e 612c 2064 623d 4e6f 6e65 293a  thena, db=None):
-000030a0: 0a20 2020 2020 2020 2063 6d64 2e43 6d64  .        cmd.Cmd
-000030b0: 2e5f 5f69 6e69 745f 5f28 7365 6c66 290a  .__init__(self).
-000030c0: 0a20 2020 2020 2020 2073 656c 662e 6174  .        self.at
-000030d0: 6865 6e61 203d 2061 7468 656e 610a 2020  hena = athena.  
-000030e0: 2020 2020 2020 7365 6c66 2e64 626e 616d        self.dbnam
-000030f0: 6520 3d20 6462 0a0a 2020 2020 2020 2020  e = db..        
-00003100: 7365 6c66 2e65 7865 6375 7469 6f6e 5f69  self.execution_i
-00003110: 6420 3d20 4e6f 6e65 0a0a 2020 2020 2020  d = None..      
-00003120: 2020 7365 6c66 2e72 6f77 5f63 6f75 6e74    self.row_count
-00003130: 203d 2030 0a0a 2020 2020 2020 2020 7365   = 0..        se
-00003140: 6c66 2e73 6574 5f70 726f 6d70 7428 290a  lf.set_prompt().
-00003150: 2020 2020 2020 2020 7365 6c66 2e70 6167          self.pag
-00003160: 6572 203d 206f 732e 656e 7669 726f 6e2e  er = os.environ.
-00003170: 6765 7428 2741 5448 454e 415f 434c 495f  get('ATHENA_CLI_
-00003180: 5041 4745 5227 2c20 4c45 5353 292e 7370  PAGER', LESS).sp
-00003190: 6c69 7428 2720 2729 0a0a 2020 2020 2020  lit(' ')..      
-000031a0: 2020 7365 6c66 2e68 6973 745f 6669 6c65    self.hist_file
-000031b0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-000031c0: 6f73 2e70 6174 682e 6578 7061 6e64 7573  os.path.expandus
-000031d0: 6572 2822 7e22 292c 2022 2e61 7468 656e  er("~"), ".athen
-000031e0: 615f 6869 7374 6f72 7922 290a 2020 2020  a_history").    
-000031f0: 2020 2020 7365 6c66 2e69 6e69 745f 6869      self.init_hi
-00003200: 7374 6f72 7928 290a 0a20 2020 2064 6566  story()..    def
-00003210: 2073 6574 5f70 726f 6d70 7428 7365 6c66   set_prompt(self
-00003220: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00003230: 7072 6f6d 7074 203d 2027 6174 6865 6e61  prompt = 'athena
-00003240: 3a25 733e 2027 2025 2073 656c 662e 6462  :%s> ' % self.db
-00003250: 6e61 6d65 2069 6620 7365 6c66 2e64 626e  name if self.dbn
-00003260: 616d 6520 656c 7365 2027 6174 6865 6e61  ame else 'athena
-00003270: 3e20 270a 0a20 2020 2064 6566 2063 6d64  > '..    def cmd
-00003280: 6c6f 6f70 5f77 6974 685f 6361 6e63 656c  loop_with_cancel
-00003290: 2873 656c 662c 2069 6e74 726f 3d4e 6f6e  (self, intro=Non
-000032a0: 6529 3a0a 2020 2020 2020 2020 7472 793a  e):.        try:
-000032b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000032c0: 662e 636d 646c 6f6f 7028 696e 7472 6f29  f.cmdloop(intro)
-000032d0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-000032e0: 4b65 7962 6f61 7264 496e 7465 7272 7570  KeyboardInterrup
-000032f0: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
-00003300: 6620 7365 6c66 2e65 7865 6375 7469 6f6e  f self.execution
-00003310: 5f69 643a 0a20 2020 2020 2020 2020 2020  _id:.           
-00003320: 2020 2020 2073 656c 662e 6174 6865 6e61       self.athena
-00003330: 2e73 746f 705f 7175 6572 795f 6578 6563  .stop_query_exec
-00003340: 7574 696f 6e28 7365 6c66 2e65 7865 6375  ution(self.execu
-00003350: 7469 6f6e 5f69 6429 0a20 2020 2020 2020  tion_id).       
-00003360: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00003370: 5c6e 5c6e 2573 2720 2520 7365 6c66 2e61  \n\n%s' % self.a
-00003380: 7468 656e 612e 636f 6e73 6f6c 655f 6c69  thena.console_li
-00003390: 6e6b 2873 656c 662e 6578 6563 7574 696f  nk(self.executio
-000033a0: 6e5f 6964 2929 0a20 2020 2020 2020 2020  n_id)).         
-000033b0: 2020 2020 2020 2070 7269 6e74 2827 5c6e         print('\n
-000033c0: 5175 6572 7920 6162 6f72 7465 6420 6279  Query aborted by
-000033d0: 2075 7365 7227 290a 2020 2020 2020 2020   user').        
-000033e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000033f0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00003400: 275c 7227 290a 2020 2020 2020 2020 2020  '\r').          
-00003410: 2020 7365 6c66 2e63 6d64 6c6f 6f70 5f77    self.cmdloop_w
-00003420: 6974 685f 6361 6e63 656c 2869 6e74 726f  ith_cancel(intro
-00003430: 290a 0a20 2020 2064 6566 2070 7265 6c6f  )..    def prelo
-00003440: 6f70 2873 656c 6629 3a0a 2020 2020 2020  op(self):.      
-00003450: 2020 6966 206f 732e 7061 7468 2e65 7869    if os.path.exi
-00003460: 7374 7328 7365 6c66 2e68 6973 745f 6669  sts(self.hist_fi
-00003470: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
-00003480: 2072 6561 646c 696e 652e 7265 6164 5f68   readline.read_h
-00003490: 6973 746f 7279 5f66 696c 6528 7365 6c66  istory_file(self
-000034a0: 2e68 6973 745f 6669 6c65 290a 0a20 2020  .hist_file)..   
-000034b0: 2064 6566 2070 6f73 746c 6f6f 7028 7365   def postloop(se
-000034c0: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
-000034d0: 662e 7361 7665 5f68 6973 746f 7279 2829  f.save_history()
-000034e0: 0a0a 2020 2020 6465 6620 696e 6974 5f68  ..    def init_h
-000034f0: 6973 746f 7279 2873 656c 6629 3a0a 2020  istory(self):.  
-00003500: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00003510: 2020 2020 2020 2072 6561 646c 696e 652e         readline.
-00003520: 7265 6164 5f68 6973 746f 7279 5f66 696c  read_history_fil
-00003530: 6528 7365 6c66 2e68 6973 745f 6669 6c65  e(self.hist_file
-00003540: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00003550: 6164 6c69 6e65 2e73 6574 5f68 6973 746f  adline.set_histo
-00003560: 7279 5f6c 656e 6774 6828 4849 5354 4f52  ry_length(HISTOR
-00003570: 595f 4649 4c45 5f53 495a 4529 0a20 2020  Y_FILE_SIZE).   
-00003580: 2020 2020 2020 2020 2072 6561 646c 696e           readlin
-00003590: 652e 7772 6974 655f 6869 7374 6f72 795f  e.write_history_
-000035a0: 6669 6c65 2873 656c 662e 6869 7374 5f66  file(self.hist_f
-000035b0: 696c 6529 0a20 2020 2020 2020 2065 7863  ile).        exc
-000035c0: 6570 7420 494f 4572 726f 723a 0a20 2020  ept IOError:.   
-000035d0: 2020 2020 2020 2020 2072 6561 646c 696e           readlin
-000035e0: 652e 7772 6974 655f 6869 7374 6f72 795f  e.write_history_
-000035f0: 6669 6c65 2873 656c 662e 6869 7374 5f66  file(self.hist_f
-00003600: 696c 6529 0a0a 2020 2020 2020 2020 6174  ile)..        at
-00003610: 6578 6974 2e72 6567 6973 7465 7228 7365  exit.register(se
-00003620: 6c66 2e73 6176 655f 6869 7374 6f72 7929  lf.save_history)
-00003630: 0a0a 2020 2020 6465 6620 7361 7665 5f68  ..    def save_h
-00003640: 6973 746f 7279 2873 656c 6629 3a0a 2020  istory(self):.  
-00003650: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00003660: 2020 2020 2020 2072 6561 646c 696e 652e         readline.
-00003670: 7772 6974 655f 6869 7374 6f72 795f 6669  write_history_fi
-00003680: 6c65 2873 656c 662e 6869 7374 5f66 696c  le(self.hist_fil
-00003690: 6529 0a20 2020 2020 2020 2065 7863 6570  e).        excep
-000036a0: 7420 494f 4572 726f 723a 0a20 2020 2020  t IOError:.     
-000036b0: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
-000036c0: 2064 6566 2064 6f5f 6865 6c70 2873 656c   def do_help(sel
-000036d0: 662c 2061 7267 293a 0a20 2020 2020 2020  f, arg):.       
-000036e0: 2068 656c 705f 6f75 7470 7574 203d 2022   help_output = "
-000036f0: 2222 0a53 7570 706f 7274 6564 2063 6f6d  "".Supported com
-00003700: 6d61 6e64 733a 0a51 5549 540a 5345 4c45  mands:.QUIT.SELE
-00003710: 4354 0a41 4c54 4552 2044 4154 4142 4153  CT.ALTER DATABAS
-00003720: 4520 3c73 6368 656d 613e 0a41 4c54 4552  E <schema>.ALTER
-00003730: 2054 4142 4c45 203c 7461 626c 653e 0a43   TABLE <table>.C
-00003740: 5245 4154 4520 4441 5441 4241 5345 203c  REATE DATABASE <
-00003750: 7363 6865 6d61 3e0a 4352 4541 5445 2054  schema>.CREATE T
-00003760: 4142 4c45 203c 7461 626c 653e 0a44 4553  ABLE <table>.DES
-00003770: 4352 4942 4520 3c74 6162 6c65 3e0a 4452  CRIBE <table>.DR
-00003780: 4f50 2044 4154 4142 4153 4520 3c73 6368  OP DATABASE <sch
-00003790: 656d 613e 0a44 524f 5020 5441 424c 4520  ema>.DROP TABLE 
-000037a0: 3c74 6162 6c65 3e0a 4d53 434b 2052 4550  <table>.MSCK REP
-000037b0: 4149 5220 5441 424c 4520 3c74 6162 6c65  AIR TABLE <table
-000037c0: 3e0a 5348 4f57 2043 4f4c 554d 4e53 2046  >.SHOW COLUMNS F
-000037d0: 524f 4d20 3c74 6162 6c65 3e0a 5348 4f57  ROM <table>.SHOW
-000037e0: 2043 5245 4154 4520 5441 424c 4520 3c74   CREATE TABLE <t
-000037f0: 6162 6c65 3e0a 5348 4f57 2044 4154 4142  able>.SHOW DATAB
-00003800: 4153 4553 205b 4c49 4b45 203c 7061 7474  ASES [LIKE <patt
-00003810: 6572 6e3e 5d0a 5348 4f57 2050 4152 5449  ern>].SHOW PARTI
-00003820: 5449 4f4e 5320 3c74 6162 6c65 3e0a 5348  TIONS <table>.SH
-00003830: 4f57 2054 4142 4c45 5320 5b49 4e20 3c73  OW TABLES [IN <s
-00003840: 6368 656d 613e 5d20 5b3c 7061 7474 6572  chema>] [<patter
-00003850: 6e3e 5d0a 5348 4f57 2054 424c 5052 4f50  n>].SHOW TBLPROP
-00003860: 4552 5449 4553 203c 7461 626c 653e 0a55  ERTIES <table>.U
-00003870: 5345 205b 3c63 6174 616c 6f67 3e2e 5d3c  SE [<catalog>.]<
-00003880: 7363 6865 6d61 3e0a 5641 4c55 4553 2072  schema>.VALUES r
-00003890: 6f77 205b 2c20 2e2e 2e5d 0a0a 5365 6520  ow [, ...]..See 
-000038a0: 6874 7470 3a2f 2f64 6f63 732e 6177 732e  http://docs.aws.
-000038b0: 616d 617a 6f6e 2e63 6f6d 2f61 7468 656e  amazon.com/athen
-000038c0: 612f 6c61 7465 7374 2f75 672f 6c61 6e67  a/latest/ug/lang
-000038d0: 7561 6765 2d72 6566 6572 656e 6365 2e68  uage-reference.h
-000038e0: 746d 6c0a 2222 220a 2020 2020 2020 2020  tml.""".        
-000038f0: 7072 696e 7428 6865 6c70 5f6f 7574 7075  print(help_outpu
-00003900: 7429 0a0a 2020 2020 6465 6620 646f 5f71  t)..    def do_q
-00003910: 7569 7428 7365 6c66 2c20 6172 6729 3a0a  uit(self, arg):.
-00003920: 2020 2020 2020 2020 7072 696e 7428 290a          print().
-00003930: 2020 2020 2020 2020 7265 7475 726e 202d          return -
-00003940: 310a 0a20 2020 2064 6566 2064 6f5f 454f  1..    def do_EO
-00003950: 4628 7365 6c66 2c20 6172 6729 3a0a 2020  F(self, arg):.  
-00003960: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00003970: 662e 646f 5f71 7569 7428 6172 6729 0a0a  f.do_quit(arg)..
-00003980: 2020 2020 6465 6620 646f 5f75 7365 2873      def do_use(s
-00003990: 656c 662c 2073 6368 656d 6129 3a0a 2020  elf, schema):.  
-000039a0: 2020 2020 2020 7365 6c66 2e64 626e 616d        self.dbnam
-000039b0: 6520 3d20 7363 6865 6d61 2e72 7374 7269  e = schema.rstri
-000039c0: 7028 273b 2729 0a20 2020 2020 2020 2073  p(';').        s
-000039d0: 656c 662e 7365 745f 7072 6f6d 7074 2829  elf.set_prompt()
-000039e0: 0a0a 2020 2020 6465 6620 646f 5f73 6574  ..    def do_set
-000039f0: 2873 656c 662c 2061 7267 293a 0a20 2020  (self, arg):.   
-00003a00: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00003a10: 2020 2020 2020 7374 6174 656d 656e 742c        statement,
-00003a20: 2070 6172 616d 5f6e 616d 652c 2076 616c   param_name, val
-00003a30: 203d 2061 7267 2e70 6172 7365 642e 7261   = arg.parsed.ra
-00003a40: 772e 7370 6c69 7428 4e6f 6e65 2c20 3229  w.split(None, 2)
-00003a50: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00003a60: 203d 2076 616c 2e73 7472 6970 2829 0a20   = val.strip(). 
-00003a70: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00003a80: 5f6e 616d 6520 3d20 7061 7261 6d5f 6e61  _name = param_na
-00003a90: 6d65 2e73 7472 6970 2829 2e6c 6f77 6572  me.strip().lower
-00003aa0: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-00003ab0: 6620 7061 7261 6d5f 6e61 6d65 203d 3d20  f param_name == 
-00003ac0: 2764 6562 7567 273a 0a20 2020 2020 2020  'debug':.       
-00003ad0: 2020 2020 2020 2020 2073 656c 662e 6174           self.at
-00003ae0: 6865 6e61 2e64 6562 7567 203d 2063 6d64  hena.debug = cmd
-00003af0: 2e63 6173 7428 5472 7565 2c20 7661 6c29  .cast(True, val)
-00003b00: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00003b10: 2856 616c 7565 4572 726f 722c 2041 7474  (ValueError, Att
-00003b20: 7269 6275 7465 4572 726f 7229 3a0a 2020  ributeError):.  
-00003b30: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-00003b40: 6f5f 7368 6f77 2861 7267 290a 2020 2020  o_show(arg).    
-00003b50: 2020 2020 7375 7065 7228 4174 6865 6e61      super(Athena
-00003b60: 5368 656c 6c2c 2073 656c 6629 2e64 6f5f  Shell, self).do_
-00003b70: 7365 7428 6172 6729 0a0a 2020 2020 6465  set(arg)..    de
-00003b80: 6620 6465 6661 756c 7428 7365 6c66 2c20  f default(self, 
-00003b90: 6c69 6e65 293a 0a20 2020 2020 2020 2073  line):.        s
-00003ba0: 656c 662e 6578 6563 7574 696f 6e5f 6964  elf.execution_id
-00003bb0: 203d 2073 656c 662e 6174 6865 6e61 2e73   = self.athena.s
-00003bc0: 7461 7274 5f71 7565 7279 5f65 7865 6375  tart_query_execu
-00003bd0: 7469 6f6e 2873 656c 662e 6462 6e61 6d65  tion(self.dbname
-00003be0: 2c20 6c69 6e65 2e66 756c 6c5f 7061 7273  , line.full_pars
-00003bf0: 6564 5f73 7461 7465 6d65 6e74 2829 290a  ed_statement()).
-00003c00: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00003c10: 656c 662e 6578 6563 7574 696f 6e5f 6964  elf.execution_id
-00003c20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00003c30: 7475 726e 0a0a 2020 2020 2020 2020 7768  turn..        wh
-00003c40: 696c 6520 5472 7565 3a0a 2020 2020 2020  ile True:.      
-00003c50: 2020 2020 2020 7374 6174 7320 3d20 7365        stats = se
-00003c60: 6c66 2e61 7468 656e 612e 6765 745f 7175  lf.athena.get_qu
-00003c70: 6572 795f 6578 6563 7574 696f 6e28 7365  ery_execution(se
-00003c80: 6c66 2e65 7865 6375 7469 6f6e 5f69 6429  lf.execution_id)
-00003c90: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-00003ca0: 7475 7320 3d20 7374 6174 735b 2751 7565  tus = stats['Que
-00003cb0: 7279 4578 6563 7574 696f 6e27 5d5b 2753  ryExecution']['S
-00003cc0: 7461 7475 7327 5d5b 2753 7461 7465 275d  tatus']['State']
-00003cd0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-00003ce0: 7475 735f 6c69 6e65 203d 2027 5175 6572  tus_line = 'Quer
-00003cf0: 7920 7b30 7d2c 207b 313a 397d 272e 666f  y {0}, {1:9}'.fo
-00003d00: 726d 6174 2873 656c 662e 6578 6563 7574  rmat(self.execut
-00003d10: 696f 6e5f 6964 2c20 7374 6174 7573 290a  ion_id, status).
-00003d20: 2020 2020 2020 2020 2020 2020 7379 732e              sys.
-00003d30: 7374 646f 7574 2e77 7269 7465 2827 5c72  stdout.write('\r
-00003d40: 2720 2b20 7374 6174 7573 5f6c 696e 6529  ' + status_line)
-00003d50: 0a20 2020 2020 2020 2020 2020 2073 7973  .            sys
-00003d60: 2e73 7464 6f75 742e 666c 7573 6828 290a  .stdout.flush().
-00003d70: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00003d80: 7461 7475 7320 696e 205b 2753 5543 4345  tatus in ['SUCCE
-00003d90: 4544 4544 272c 2027 4641 494c 4544 272c  EDED', 'FAILED',
-00003da0: 2027 4341 4e43 454c 4c45 4427 5d3a 0a20   'CANCELLED']:. 
-00003db0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00003dc0: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-00003dd0: 2074 696d 652e 736c 6565 7028 302e 3229   time.sleep(0.2)
-00003de0: 2020 2320 3230 306d 730a 0a20 2020 2020    # 200ms..     
-00003df0: 2020 2073 7973 2e73 7464 6f75 742e 7772     sys.stdout.wr
-00003e00: 6974 6528 275c 7227 202b 2027 2027 202a  ite('\r' + ' ' *
-00003e10: 206c 656e 2873 7461 7475 735f 6c69 6e65   len(status_line
-00003e20: 2920 2b20 275c 7227 2920 2023 2064 656c  ) + '\r')  # del
-00003e30: 6574 6520 7175 6572 7920 7374 6174 7573  ete query status
-00003e40: 206c 696e 650a 2020 2020 2020 2020 7379   line.        sy
-00003e50: 732e 7374 646f 7574 2e66 6c75 7368 2829  s.stdout.flush()
-00003e60: 0a0a 2020 2020 2020 2020 6966 2073 7461  ..        if sta
-00003e70: 7475 7320 3d3d 2027 5355 4343 4545 4445  tus == 'SUCCEEDE
-00003e80: 4427 3a0a 2020 2020 2020 2020 2020 2020  D':.            
-00003e90: 7265 7375 6c74 7320 3d20 7365 6c66 2e61  results = self.a
-00003ea0: 7468 656e 612e 6765 745f 7175 6572 795f  thena.get_query_
-00003eb0: 7265 7375 6c74 7328 7365 6c66 2e65 7865  results(self.exe
-00003ec0: 6375 7469 6f6e 5f69 6429 0a20 2020 2020  cution_id).     
-00003ed0: 2020 2020 2020 2068 6561 6465 7273 203d         headers =
-00003ee0: 205b 685b 274e 616d 6527 5d20 666f 7220   [h['Name'] for 
-00003ef0: 6820 696e 2072 6573 756c 7473 5b27 5265  h in results['Re
-00003f00: 7375 6c74 5365 7427 5d5b 2752 6573 756c  sultSet']['Resul
-00003f10: 7453 6574 4d65 7461 6461 7461 275d 5b27  tSetMetadata']['
-00003f20: 436f 6c75 6d6e 496e 666f 275d 5d0a 2020  ColumnInfo']].  
-00003f30: 2020 2020 2020 2020 2020 726f 775f 636f            row_co
-00003f40: 756e 7420 3d20 6c65 6e28 7265 7375 6c74  unt = len(result
-00003f50: 735b 2752 6573 756c 7453 6574 275d 5b27  s['ResultSet']['
-00003f60: 526f 7773 275d 290a 0a20 2020 2020 2020  Rows'])..       
-00003f70: 2020 2020 2069 6620 6865 6164 6572 7320       if headers 
-00003f80: 616e 6420 6c65 6e28 7265 7375 6c74 735b  and len(results[
-00003f90: 2752 6573 756c 7453 6574 275d 5b27 526f  'ResultSet']['Ro
-00003fa0: 7773 275d 2920 616e 6420 7265 7375 6c74  ws']) and result
-00003fb0: 735b 2752 6573 756c 7453 6574 275d 5b27  s['ResultSet']['
-00003fc0: 526f 7773 275d 5b30 5d5b 2744 6174 6127  Rows'][0]['Data'
-00003fd0: 5d5b 305d 2e67 6574 2827 5661 7243 6861  ][0].get('VarCha
-00003fe0: 7256 616c 7565 272c 204e 6f6e 6529 203d  rValue', None) =
-00003ff0: 3d20 6865 6164 6572 735b 305d 3a0a 2020  = headers[0]:.  
-00004000: 2020 2020 2020 2020 2020 2020 2020 726f                ro
-00004010: 775f 636f 756e 7420 2d3d 2031 2020 2320  w_count -= 1  # 
-00004020: 646f 6e27 7420 636f 756e 7420 6865 6164  don't count head
-00004030: 6572 0a0a 2020 2020 2020 2020 2020 2020  er..            
-00004040: 7072 6f63 6573 7320 3d20 7375 6270 726f  process = subpro
-00004050: 6365 7373 2e50 6f70 656e 2873 656c 662e  cess.Popen(self.
-00004060: 7061 6765 722c 2073 7464 696e 3d73 7562  pager, stdin=sub
-00004070: 7072 6f63 6573 732e 5049 5045 290a 2020  process.PIPE).  
-00004080: 2020 2020 2020 2020 2020 7072 6f63 6573            proces
-00004090: 732e 7374 6469 6e2e 7772 6974 6528 7461  s.stdin.write(ta
-000040a0: 6275 6c61 7465 285b 7820 666f 7220 7820  bulate([x for x 
-000040b0: 696e 2073 656c 662e 6174 6865 6e61 2e79  in self.athena.y
-000040c0: 6965 6c64 5f72 6f77 7328 7265 7375 6c74  ield_rows(result
-000040d0: 732c 2068 6561 6465 7273 295d 2c20 6865  s, headers)], he
-000040e0: 6164 6572 733d 6865 6164 6572 732c 2074  aders=headers, t
-000040f0: 6162 6c65 666d 743d 2770 7265 7374 6f27  ablefmt='presto'
-00004100: 292e 656e 636f 6465 2827 7574 662d 3827  ).encode('utf-8'
-00004110: 2929 0a20 2020 2020 2020 2020 2020 2070  )).            p
-00004120: 726f 6365 7373 2e63 6f6d 6d75 6e69 6361  rocess.communica
-00004130: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
-00004140: 2070 7269 6e74 2827 2825 7320 726f 7773   print('(%s rows
-00004150: 295c 6e27 2025 2072 6f77 5f63 6f75 6e74  )\n' % row_count
-00004160: 290a 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-00004170: 2827 5175 6572 7920 7b30 7d2c 207b 317d  ('Query {0}, {1}
-00004180: 272e 666f 726d 6174 2873 656c 662e 6578  '.format(self.ex
-00004190: 6563 7574 696f 6e5f 6964 2c20 7374 6174  ecution_id, stat
-000041a0: 7573 2929 0a20 2020 2020 2020 2069 6620  us)).        if 
-000041b0: 7374 6174 7573 203d 3d20 2746 4149 4c45  status == 'FAILE
-000041c0: 4427 3a0a 2020 2020 2020 2020 2020 2020  D':.            
-000041d0: 7072 696e 7428 7374 6174 735b 2751 7565  print(stats['Que
-000041e0: 7279 4578 6563 7574 696f 6e27 5d5b 2753  ryExecution']['S
-000041f0: 7461 7475 7327 5d5b 2753 7461 7465 4368  tatus']['StateCh
-00004200: 616e 6765 5265 6173 6f6e 275d 290a 2020  angeReason']).  
-00004210: 2020 2020 2020 7072 696e 7428 7365 6c66        print(self
-00004220: 2e61 7468 656e 612e 636f 6e73 6f6c 655f  .athena.console_
-00004230: 6c69 6e6b 2873 656c 662e 6578 6563 7574  link(self.execut
-00004240: 696f 6e5f 6964 2929 0a0a 2020 2020 2020  ion_id))..      
-00004250: 2020 7375 626d 6973 7369 6f6e 5f64 6174    submission_dat
-00004260: 6520 3d20 7374 6174 735b 2751 7565 7279  e = stats['Query
-00004270: 4578 6563 7574 696f 6e27 5d5b 2753 7461  Execution']['Sta
-00004280: 7475 7327 5d5b 2753 7562 6d69 7373 696f  tus']['Submissio
-00004290: 6e44 6174 6554 696d 6527 5d0a 2020 2020  nDateTime'].    
-000042a0: 2020 2020 636f 6d70 6c65 7469 6f6e 5f64      completion_d
-000042b0: 6174 6520 3d20 7374 6174 735b 2751 7565  ate = stats['Que
-000042c0: 7279 4578 6563 7574 696f 6e27 5d5b 2753  ryExecution']['S
-000042d0: 7461 7475 7327 5d5b 2743 6f6d 706c 6574  tatus']['Complet
-000042e0: 696f 6e44 6174 6554 696d 6527 5d0a 2020  ionDateTime'].  
-000042f0: 2020 2020 2020 6578 6563 7574 696f 6e5f        execution_
-00004300: 7469 6d65 203d 2073 7461 7473 5b27 5175  time = stats['Qu
-00004310: 6572 7945 7865 6375 7469 6f6e 275d 5b27  eryExecution']['
-00004320: 5374 6174 6973 7469 6373 275d 5b27 456e  Statistics']['En
-00004330: 6769 6e65 4578 6563 7574 696f 6e54 696d  gineExecutionTim
-00004340: 6549 6e4d 696c 6c69 7327 5d0a 2020 2020  eInMillis'].    
-00004350: 2020 2020 6461 7461 5f73 6361 6e6e 6564      data_scanned
-00004360: 203d 2073 7461 7473 5b27 5175 6572 7945   = stats['QueryE
-00004370: 7865 6375 7469 6f6e 275d 5b27 5374 6174  xecution']['Stat
-00004380: 6973 7469 6373 275d 5b27 4461 7461 5363  istics']['DataSc
-00004390: 616e 6e65 6449 6e42 7974 6573 275d 0a20  annedInBytes']. 
-000043a0: 2020 2020 2020 2071 7565 7279 5f63 6f73         query_cos
-000043b0: 7420 3d20 6461 7461 5f73 6361 6e6e 6564  t = data_scanned
-000043c0: 202f 2031 3030 3030 3030 3030 3030 3030   / 1000000000000
-000043d0: 2e30 202a 2035 2e30 0a0a 2020 2020 2020  .0 * 5.0..      
-000043e0: 2020 7072 696e 7428 2754 696d 653a 207b    print('Time: {
-000043f0: 7d2c 2043 5055 2054 696d 653a 207b 7d6d  }, CPU Time: {}m
-00004400: 7320 746f 7461 6c2c 2044 6174 6120 5363  s total, Data Sc
-00004410: 616e 6e65 643a 207b 7d2c 2043 6f73 743a  anned: {}, Cost:
-00004420: 2024 7b3a 2c2e 3266 7d5c 6e27 2e66 6f72   ${:,.2f}\n'.for
-00004430: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-00004440: 2073 7472 2863 6f6d 706c 6574 696f 6e5f   str(completion_
-00004450: 6461 7465 202d 2073 7562 6d69 7373 696f  date - submissio
-00004460: 6e5f 6461 7465 292e 7370 6c69 7428 272e  n_date).split('.
-00004470: 2729 5b30 5d2c 0a20 2020 2020 2020 2020  ')[0],.         
-00004480: 2020 2065 7865 6375 7469 6f6e 5f74 696d     execution_tim
-00004490: 652c 0a20 2020 2020 2020 2020 2020 2068  e,.            h
-000044a0: 756d 616e 5f72 6561 6461 626c 6528 6461  uman_readable(da
-000044b0: 7461 5f73 6361 6e6e 6564 292c 0a20 2020  ta_scanned),.   
-000044c0: 2020 2020 2020 2020 2071 7565 7279 5f63           query_c
-000044d0: 6f73 740a 2020 2020 2020 2020 2929 0a0a  ost.        ))..
-000044e0: 0a63 6c61 7373 2041 7468 656e 6128 6f62  .class Athena(ob
-000044f0: 6a65 6374 293a 0a0a 2020 2020 6465 6620  ject):..    def 
-00004500: 5f5f 696e 6974 5f5f 2873 656c 662c 2070  __init__(self, p
-00004510: 726f 6669 6c65 2c20 7265 6769 6f6e 3d4e  rofile, region=N
-00004520: 6f6e 652c 2062 7563 6b65 743d 4e6f 6e65  one, bucket=None
-00004530: 2c20 6465 6275 673d 4661 6c73 652c 2065  , debug=False, e
-00004540: 6e63 7279 7074 696f 6e3d 4661 6c73 6529  ncryption=False)
-00004550: 3a0a 0a20 2020 2020 2020 2073 656c 662e  :..        self.
-00004560: 7365 7373 696f 6e20 3d20 626f 746f 332e  session = boto3.
-00004570: 5365 7373 696f 6e28 7072 6f66 696c 655f  Session(profile_
-00004580: 6e61 6d65 3d70 726f 6669 6c65 2c20 7265  name=profile, re
-00004590: 6769 6f6e 5f6e 616d 653d 7265 6769 6f6e  gion_name=region
-000045a0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000045b0: 7468 656e 6120 3d20 7365 6c66 2e73 6573  thena = self.ses
-000045c0: 7369 6f6e 2e63 6c69 656e 7428 2761 7468  sion.client('ath
-000045d0: 656e 6127 290a 0a20 2020 2020 2020 2073  ena')..        s
-000045e0: 656c 662e 7265 6769 6f6e 203d 2072 6567  elf.region = reg
-000045f0: 696f 6e20 6f72 206f 732e 656e 7669 726f  ion or os.enviro
-00004600: 6e2e 6765 7428 2741 5753 5f44 4546 4155  n.get('AWS_DEFAU
-00004610: 4c54 5f52 4547 494f 4e27 2c20 4e6f 6e65  LT_REGION', None
-00004620: 2920 6f72 2073 656c 662e 7365 7373 696f  ) or self.sessio
-00004630: 6e2e 7265 6769 6f6e 5f6e 616d 650a 0a20  n.region_name.. 
-00004640: 2020 2020 2020 2073 656c 662e 6275 636b         self.buck
-00004650: 6574 203d 2062 7563 6b65 7420 6f72 2073  et = bucket or s
-00004660: 656c 662e 6465 6661 756c 745f 6275 636b  elf.default_buck
-00004670: 6574 0a20 2020 2020 2020 2073 656c 662e  et.        self.
-00004680: 6465 6275 6720 3d20 6465 6275 670a 2020  debug = debug.  
-00004690: 2020 2020 2020 7365 6c66 2e65 6e63 7279        self.encry
-000046a0: 7074 696f 6e20 3d20 656e 6372 7970 7469  ption = encrypti
-000046b0: 6f6e 0a0a 2020 2020 4070 726f 7065 7274  on..    @propert
-000046c0: 790a 2020 2020 6465 6620 6465 6661 756c  y.    def defaul
-000046d0: 745f 6275 636b 6574 2873 656c 6629 3a0a  t_bucket(self):.
-000046e0: 2020 2020 2020 2020 6163 636f 756e 745f          account_
-000046f0: 6964 203d 2073 656c 662e 7365 7373 696f  id = self.sessio
-00004700: 6e2e 636c 6965 6e74 2827 7374 7327 292e  n.client('sts').
-00004710: 6765 745f 6361 6c6c 6572 5f69 6465 6e74  get_caller_ident
-00004720: 6974 7928 292e 6765 7428 2741 6363 6f75  ity().get('Accou
-00004730: 6e74 2729 0a20 2020 2020 2020 2072 6574  nt').        ret
-00004740: 7572 6e20 2773 333a 2f2f 7b7d 2d71 7565  urn 's3://{}-que
-00004750: 7279 2d72 6573 756c 7473 2d7b 7d2d 7b7d  ry-results-{}-{}
-00004760: 272e 666f 726d 6174 2873 656c 662e 7365  '.format(self.se
-00004770: 7373 696f 6e2e 7072 6f66 696c 655f 6e61  ssion.profile_na
-00004780: 6d65 206f 7220 2761 7773 2d61 7468 656e  me or 'aws-athen
-00004790: 6127 2c20 6163 636f 756e 745f 6964 2c20  a', account_id, 
-000047a0: 7365 6c66 2e72 6567 696f 6e29 0a0a 2020  self.region)..  
-000047b0: 2020 6465 6620 7374 6172 745f 7175 6572    def start_quer
-000047c0: 795f 6578 6563 7574 696f 6e28 7365 6c66  y_execution(self
-000047d0: 2c20 6462 2c20 7175 6572 7929 3a0a 2020  , db, query):.  
-000047e0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-000047f0: 2020 2020 2020 2069 6620 6e6f 7420 6462         if not db
-00004800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004810: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00004820: 6f72 2827 5363 6865 6d61 206d 7573 7420  or('Schema must 
-00004830: 6265 2073 7065 6369 6669 6564 2077 6865  be specified whe
-00004840: 6e20 7365 7373 696f 6e20 7363 6865 6d61  n session schema
-00004850: 2069 7320 6e6f 7420 7365 7427 290a 0a20   is not set').. 
-00004860: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00004870: 745f 636f 6e66 6967 7572 6174 696f 6e20  t_configuration 
-00004880: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00004890: 2020 2020 274f 7574 7075 744c 6f63 6174      'OutputLocat
-000048a0: 696f 6e27 3a20 7365 6c66 2e62 7563 6b65  ion': self.bucke
-000048b0: 742c 0a20 2020 2020 2020 2020 2020 207d  t,.            }
-000048c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000048d0: 7365 6c66 2e65 6e63 7279 7074 696f 6e3a  self.encryption:
-000048e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000048f0: 2072 6573 756c 745f 636f 6e66 6967 7572   result_configur
-00004900: 6174 696f 6e5b 2745 6e63 7279 7074 696f  ation['Encryptio
-00004910: 6e43 6f6e 6669 6775 7261 7469 6f6e 275d  nConfiguration']
-00004920: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00004930: 2020 2020 2020 2020 2027 456e 6372 7970           'Encryp
-00004940: 7469 6f6e 4f70 7469 6f6e 273a 2027 5353  tionOption': 'SS
-00004950: 455f 5333 270a 2020 2020 2020 2020 2020  E_S3'.          
-00004960: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-00004970: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00004980: 2e61 7468 656e 612e 7374 6172 745f 7175  .athena.start_qu
-00004990: 6572 795f 6578 6563 7574 696f 6e28 0a20  ery_execution(. 
-000049a0: 2020 2020 2020 2020 2020 2020 2020 2051                 Q
-000049b0: 7565 7279 5374 7269 6e67 3d71 7565 7279  ueryString=query
-000049c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000049d0: 2020 436c 6965 6e74 5265 7175 6573 7454    ClientRequestT
-000049e0: 6f6b 656e 3d73 7472 2875 7569 642e 7575  oken=str(uuid.uu
-000049f0: 6964 3428 2929 2c0a 2020 2020 2020 2020  id4()),.        
-00004a00: 2020 2020 2020 2020 5175 6572 7945 7865          QueryExe
-00004a10: 6375 7469 6f6e 436f 6e74 6578 743d 7b0a  cutionContext={.
-00004a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a30: 2020 2020 2744 6174 6162 6173 6527 3a20      'Database': 
-00004a40: 6462 0a20 2020 2020 2020 2020 2020 2020  db.             
-00004a50: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00004a60: 2020 2020 2020 5265 7375 6c74 436f 6e66        ResultConf
-00004a70: 6967 7572 6174 696f 6e3d 7265 7375 6c74  iguration=result
-00004a80: 5f63 6f6e 6669 6775 7261 7469 6f6e 0a20  _configuration. 
-00004a90: 2020 2020 2020 2020 2020 2029 5b27 5175             )['Qu
-00004aa0: 6572 7945 7865 6375 7469 6f6e 4964 275d  eryExecutionId']
-00004ab0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00004ac0: 2843 6c69 656e 7445 7272 6f72 2c20 5061  (ClientError, Pa
-00004ad0: 7261 6d56 616c 6964 6174 696f 6e45 7272  ramValidationErr
-00004ae0: 6f72 2c20 5661 6c75 6545 7272 6f72 2920  or, ValueError) 
-00004af0: 6173 2065 3a0a 2020 2020 2020 2020 2020  as e:.          
-00004b00: 2020 7072 696e 7428 6529 0a20 2020 2020    print(e).     
-00004b10: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-00004b20: 2020 2064 6566 2067 6574 5f71 7565 7279     def get_query
-00004b30: 5f65 7865 6375 7469 6f6e 2873 656c 662c  _execution(self,
-00004b40: 2065 7865 6375 7469 6f6e 5f69 6429 3a0a   execution_id):.
-00004b50: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00004b60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00004b70: 7365 6c66 2e61 7468 656e 612e 6765 745f  self.athena.get_
-00004b80: 7175 6572 795f 6578 6563 7574 696f 6e28  query_execution(
-00004b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004ba0: 2051 7565 7279 4578 6563 7574 696f 6e49   QueryExecutionI
-00004bb0: 643d 6578 6563 7574 696f 6e5f 6964 0a20  d=execution_id. 
-00004bc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00004bd0: 2020 2020 2065 7863 6570 7420 436c 6965       except Clie
-00004be0: 6e74 4572 726f 7220 6173 2065 3a0a 2020  ntError as e:.  
-00004bf0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00004c00: 6529 0a0a 2020 2020 6465 6620 6765 745f  e)..    def get_
-00004c10: 7175 6572 795f 7265 7375 6c74 7328 7365  query_results(se
-00004c20: 6c66 2c20 6578 6563 7574 696f 6e5f 6964  lf, execution_id
-00004c30: 293a 0a20 2020 2020 2020 2074 7279 3a0a  ):.        try:.
-00004c40: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00004c50: 6c74 7320 3d20 4e6f 6e65 0a20 2020 2020  lts = None.     
-00004c60: 2020 2020 2020 2070 6167 696e 6174 6f72         paginator
-00004c70: 203d 2073 656c 662e 6174 6865 6e61 2e67   = self.athena.g
-00004c80: 6574 5f70 6167 696e 6174 6f72 2827 6765  et_paginator('ge
-00004c90: 745f 7175 6572 795f 7265 7375 6c74 7327  t_query_results'
-00004ca0: 290a 2020 2020 2020 2020 2020 2020 7061  ).            pa
-00004cb0: 6765 5f69 7465 7261 746f 7220 3d20 7061  ge_iterator = pa
-00004cc0: 6769 6e61 746f 722e 7061 6769 6e61 7465  ginator.paginate
-00004cd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00004ce0: 2020 5175 6572 7945 7865 6375 7469 6f6e    QueryExecution
-00004cf0: 4964 3d65 7865 6375 7469 6f6e 5f69 640a  Id=execution_id.
-00004d00: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00004d10: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-00004d20: 6167 6520 696e 2070 6167 655f 6974 6572  age in page_iter
-00004d30: 6174 6f72 3a0a 2020 2020 2020 2020 2020  ator:.          
-00004d40: 2020 2020 2020 6966 2072 6573 756c 7473        if results
-00004d50: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00004d60: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00004d70: 7375 6c74 7320 3d20 7061 6765 0a20 2020  sults = page.   
-00004d80: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00004d90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00004da0: 2020 2020 2020 2072 6573 756c 7473 5b27         results['
-00004db0: 5265 7375 6c74 5365 7427 5d5b 2752 6f77  ResultSet']['Row
-00004dc0: 7327 5d2e 6578 7465 6e64 2870 6167 655b  s'].extend(page[
-00004dd0: 2752 6573 756c 7453 6574 275d 5b27 526f  'ResultSet']['Ro
-00004de0: 7773 275d 290a 2020 2020 2020 2020 6578  ws']).        ex
-00004df0: 6365 7074 2043 6c69 656e 7445 7272 6f72  cept ClientError
-00004e00: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
-00004e10: 2020 2073 7973 2e65 7869 7428 6529 0a0a     sys.exit(e)..
-00004e20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00004e30: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
-00004e40: 2020 2070 7269 6e74 286a 736f 6e2e 6475     print(json.du
-00004e50: 6d70 7328 7265 7375 6c74 732c 2069 6e64  mps(results, ind
-00004e60: 656e 743d 3229 290a 0a20 2020 2020 2020  ent=2))..       
-00004e70: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
-00004e80: 0a20 2020 2064 6566 2073 746f 705f 7175  .    def stop_qu
-00004e90: 6572 795f 6578 6563 7574 696f 6e28 7365  ery_execution(se
-00004ea0: 6c66 2c20 6578 6563 7574 696f 6e5f 6964  lf, execution_id
-00004eb0: 293a 0a20 2020 2020 2020 2074 7279 3a0a  ):.        try:.
-00004ec0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00004ed0: 726e 2073 656c 662e 6174 6865 6e61 2e73  rn self.athena.s
-00004ee0: 746f 705f 7175 6572 795f 6578 6563 7574  top_query_execut
-00004ef0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00004f00: 2020 2020 2051 7565 7279 4578 6563 7574       QueryExecut
-00004f10: 696f 6e49 643d 6578 6563 7574 696f 6e5f  ionId=execution_
-00004f20: 6964 0a20 2020 2020 2020 2020 2020 2029  id.            )
-00004f30: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00004f40: 436c 6965 6e74 4572 726f 7220 6173 2065  ClientError as e
-00004f50: 3a0a 2020 2020 2020 2020 2020 2020 7379  :.            sy
-00004f60: 732e 6578 6974 2865 290a 0a20 2020 2040  s.exit(e)..    @
-00004f70: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00004f80: 2064 6566 2079 6965 6c64 5f72 6f77 7328   def yield_rows(
-00004f90: 7265 7375 6c74 732c 2068 6561 6465 7273  results, headers
-00004fa0: 293a 0a20 2020 2020 2020 2066 6f72 2072  ):.        for r
-00004fb0: 6f77 2069 6e20 7265 7375 6c74 735b 2752  ow in results['R
-00004fc0: 6573 756c 7453 6574 275d 5b27 526f 7773  esultSet']['Rows
-00004fd0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00004fe0: 2320 6874 7470 733a 2f2f 666f 7275 6d73  # https://forums
-00004ff0: 2e61 7773 2e61 6d61 7a6f 6e2e 636f 6d2f  .aws.amazon.com/
-00005000: 7468 7265 6164 2e6a 7370 613f 7468 7265  thread.jspa?thre
-00005010: 6164 4944 3d32 3536 3530 350a 2020 2020  adID=256505.    
-00005020: 2020 2020 2020 2020 6966 2068 6561 6465          if heade
-00005030: 7273 2061 6e64 2072 6f77 5b27 4461 7461  rs and row['Data
-00005040: 275d 5b30 5d2e 6765 7428 2756 6172 4368  '][0].get('VarCh
-00005050: 6172 5661 6c75 6527 2c20 4e6f 6e65 2920  arValue', None) 
-00005060: 3d3d 2068 6561 6465 7273 5b30 5d3a 0a20  == headers[0]:. 
-00005070: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00005080: 6f6e 7469 6e75 6520 2023 2073 6b69 7020  ontinue  # skip 
-00005090: 6865 6164 6572 0a20 2020 2020 2020 2020  header.         
-000050a0: 2020 2079 6965 6c64 205b 642e 6765 7428     yield [d.get(
-000050b0: 2756 6172 4368 6172 5661 6c75 6527 2c20  'VarCharValue', 
-000050c0: 274e 554c 4c27 2920 666f 7220 6420 696e  'NULL') for d in
-000050d0: 2072 6f77 5b27 4461 7461 275d 5d0a 0a20   row['Data']].. 
-000050e0: 2020 2064 6566 2063 6f6e 736f 6c65 5f6c     def console_l
-000050f0: 696e 6b28 7365 6c66 2c20 6578 6563 7574  ink(self, execut
-00005100: 696f 6e5f 6964 293a 0a20 2020 2020 2020  ion_id):.       
-00005110: 2072 6574 7572 6e20 2768 7474 7073 3a2f   return 'https:/
-00005120: 2f7b 307d 2e63 6f6e 736f 6c65 2e61 7773  /{0}.console.aws
-00005130: 2e61 6d61 7a6f 6e2e 636f 6d2f 6174 6865  .amazon.com/athe
-00005140: 6e61 2f68 6f6d 653f 666f 7263 6526 7265  na/home?force&re
-00005150: 6769 6f6e 3d7b 307d 2371 7565 7279 2f68  gion={0}#query/h
-00005160: 6973 746f 7279 2f7b 317d 272e 666f 726d  istory/{1}'.form
-00005170: 6174 2873 656c 662e 7265 6769 6f6e 2c20  at(self.region, 
-00005180: 6578 6563 7574 696f 6e5f 6964 290a 0a0a  execution_id)...
-00005190: 6465 6620 6875 6d61 6e5f 7265 6164 6162  def human_readab
-000051a0: 6c65 2873 697a 652c 2070 7265 6369 7369  le(size, precisi
-000051b0: 6f6e 3d32 293a 0a20 2020 2073 7566 6669  on=2):.    suffi
-000051c0: 7865 7320 3d20 5b27 4227 2c20 274b 4227  xes = ['B', 'KB'
-000051d0: 2c20 274d 4227 2c20 2747 4227 2c20 2754  , 'MB', 'GB', 'T
-000051e0: 4227 5d0a 2020 2020 7375 6666 6978 496e  B'].    suffixIn
-000051f0: 6465 7820 3d20 300a 2020 2020 7768 696c  dex = 0.    whil
-00005200: 6520 7369 7a65 203e 2031 3032 3420 616e  e size > 1024 an
-00005210: 6420 7375 6666 6978 496e 6465 7820 3c20  d suffixIndex < 
-00005220: 343a 0a20 2020 2020 2020 2073 7566 6669  4:.        suffi
-00005230: 7849 6e64 6578 202b 3d20 3120 2369 6e63  xIndex += 1 #inc
-00005240: 7265 6d65 6e74 2074 6865 2069 6e64 6578  rement the index
-00005250: 206f 6620 7468 6520 7375 6666 6978 0a20   of the suffix. 
-00005260: 2020 2020 2020 2073 697a 6520 3d20 7369         size = si
-00005270: 7a65 2f31 3032 342e 3020 2361 7070 6c79  ze/1024.0 #apply
-00005280: 2074 6865 2064 6976 6973 696f 6e0a 2020   the division.  
-00005290: 2020 7265 7475 726e 2022 252e 2a66 2573    return "%.*f%s
-000052a0: 2225 2870 7265 6369 7369 6f6e 2c20 7369  "%(precision, si
-000052b0: 7a65 2c20 7375 6666 6978 6573 5b73 7566  ze, suffixes[suf
-000052c0: 6669 7849 6e64 6578 5d29 0a0a 0a64 6566  fixIndex])...def
-000052d0: 206d 6169 6e28 293a 0a0a 2020 2020 7061   main():..    pa
-000052e0: 7273 6572 203d 2061 7267 7061 7273 652e  rser = argparse.
-000052f0: 4172 6775 6d65 6e74 5061 7273 6572 280a  ArgumentParser(.
-00005300: 2020 2020 2020 2020 7072 6f67 3d27 6174          prog='at
-00005310: 6865 6e61 272c 0a20 2020 2020 2020 2075  hena',.        u
-00005320: 7361 6765 3d27 6174 6865 6e61 205b 2d2d  sage='athena [--
-00005330: 6465 6275 675d 205b 2d2d 6578 6563 7574  debug] [--execut
-00005340: 6520 3c73 7461 7465 6d65 6e74 3e5d 205b  e <statement>] [
-00005350: 2d2d 6f75 7470 7574 2d66 6f72 6d61 7420  --output-format 
-00005360: 3c66 6f72 6d61 743e 5d20 5b2d 2d73 6368  <format>] [--sch
-00005370: 656d 6120 3c73 6368 656d 613e 5d27 0a20  ema <schema>]'. 
-00005380: 2020 2020 2020 2020 2020 2020 2027 205b               ' [
-00005390: 2d2d 7072 6f66 696c 6520 3c70 726f 6669  --profile <profi
-000053a0: 6c65 3e5d 205b 2d2d 7265 6769 6f6e 203c  le>] [--region <
-000053b0: 7265 6769 6f6e 3e5d 205b 2d2d 7333 2d62  region>] [--s3-b
-000053c0: 7563 6b65 7420 3c62 7563 6b65 743e 5d20  ucket <bucket>] 
-000053d0: 5b2d 2d73 6572 7665 722d 7369 6465 2d65  [--server-side-e
-000053e0: 6e63 7279 7074 696f 6e5d 205b 2d2d 7665  ncryption] [--ve
-000053f0: 7273 696f 6e5d 272c 0a20 2020 2020 2020  rsion]',.       
-00005400: 2064 6573 6372 6970 7469 6f6e 3d27 4174   description='At
-00005410: 6865 6e61 2069 6e74 6572 6163 7469 7665  hena interactive
-00005420: 2063 6f6e 736f 6c65 270a 2020 2020 290a   console'.    ).
-00005430: 2020 2020 7061 7273 6572 2e61 6464 5f61      parser.add_a
-00005440: 7267 756d 656e 7428 0a20 2020 2020 2020  rgument(.       
-00005450: 2027 2d2d 6465 6275 6727 2c0a 2020 2020   '--debug',.    
-00005460: 2020 2020 6163 7469 6f6e 3d27 7374 6f72      action='stor
-00005470: 655f 7472 7565 272c 0a20 2020 2020 2020  e_true',.       
-00005480: 2068 656c 703d 2765 6e61 626c 6520 6465   help='enable de
-00005490: 6275 6720 6d6f 6465 270a 2020 2020 290a  bug mode'.    ).
-000054a0: 2020 2020 7061 7273 6572 2e61 6464 5f61      parser.add_a
-000054b0: 7267 756d 656e 7428 0a20 2020 2020 2020  rgument(.       
-000054c0: 2027 2d2d 6578 6563 7574 6527 2c0a 2020   '--execute',.  
-000054d0: 2020 2020 2020 6d65 7461 7661 723d 2753        metavar='S
-000054e0: 5441 5445 4d45 4e54 272c 0a20 2020 2020  TATEMENT',.     
-000054f0: 2020 2068 656c 703d 2765 7865 6375 7465     help='execute
-00005500: 2073 7461 7465 6d65 6e74 2069 6e20 6261   statement in ba
-00005510: 7463 6820 6d6f 6465 270a 2020 2020 290a  tch mode'.    ).
-00005520: 2020 2020 7061 7273 6572 2e61 6464 5f61      parser.add_a
-00005530: 7267 756d 656e 7428 0a20 2020 2020 2020  rgument(.       
-00005540: 2027 2d2d 6f75 7470 7574 2d66 6f72 6d61   '--output-forma
-00005550: 7427 2c0a 2020 2020 2020 2020 6465 7374  t',.        dest
-00005560: 3d27 666f 726d 6174 272c 0a20 2020 2020  ='format',.     
-00005570: 2020 2068 656c 703d 276f 7574 7075 7420     help='output 
-00005580: 666f 726d 6174 2066 6f72 2062 6174 6368  format for batch
-00005590: 206d 6f64 6520 5b41 4c49 474e 4544 2c20   mode [ALIGNED, 
-000055a0: 5645 5254 4943 414c 2c20 4353 562c 2054  VERTICAL, CSV, T
-000055b0: 5356 2c20 4353 565f 4845 4144 4552 2c20  SV, CSV_HEADER, 
-000055c0: 5453 565f 4845 4144 4552 2c20 4e55 4c4c  TSV_HEADER, NULL
-000055d0: 5d27 0a20 2020 2029 0a20 2020 2070 6172  ]'.    ).    par
-000055e0: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
-000055f0: 280a 2020 2020 2020 2020 272d 2d73 6368  (.        '--sch
-00005600: 656d 6127 2c0a 2020 2020 2020 2020 272d  ema',.        '-
-00005610: 2d64 6174 6162 6173 6527 2c0a 2020 2020  -database',.    
-00005620: 2020 2020 272d 2d64 6227 2c0a 2020 2020      '--db',.    
-00005630: 2020 2020 6865 6c70 3d27 6465 6661 756c      help='defaul
-00005640: 7420 7363 6865 6d61 270a 2020 2020 290a  t schema'.    ).
-00005650: 2020 2020 7061 7273 6572 2e61 6464 5f61      parser.add_a
-00005660: 7267 756d 656e 7428 0a20 2020 2020 2020  rgument(.       
-00005670: 2027 2d2d 7072 6f66 696c 6527 2c0a 2020   '--profile',.  
-00005680: 2020 2020 2020 6865 6c70 3d27 4157 5320        help='AWS 
-00005690: 7072 6f66 696c 6527 0a20 2020 2029 0a20  profile'.    ). 
-000056a0: 2020 2070 6172 7365 722e 6164 645f 6172     parser.add_ar
-000056b0: 6775 6d65 6e74 280a 2020 2020 2020 2020  gument(.        
-000056c0: 272d 2d72 6567 696f 6e27 2c0a 2020 2020  '--region',.    
-000056d0: 2020 2020 6865 6c70 3d27 4157 5320 7265      help='AWS re
-000056e0: 6769 6f6e 270a 2020 2020 290a 2020 2020  gion'.    ).    
-000056f0: 7061 7273 6572 2e61 6464 5f61 7267 756d  parser.add_argum
-00005700: 656e 7428 0a20 2020 2020 2020 2027 2d2d  ent(.        '--
-00005710: 7333 2d62 7563 6b65 7427 2c0a 2020 2020  s3-bucket',.    
-00005720: 2020 2020 272d 2d62 7563 6b65 7427 2c0a      '--bucket',.
-00005730: 2020 2020 2020 2020 6465 7374 3d27 6275          dest='bu
-00005740: 636b 6574 272c 0a20 2020 2020 2020 2068  cket',.        h
-00005750: 656c 703d 2741 5753 2053 3320 6275 636b  elp='AWS S3 buck
-00005760: 6574 2066 6f72 2071 7565 7279 2072 6573  et for query res
-00005770: 756c 7473 270a 2020 2020 290a 2020 2020  ults'.    ).    
-00005780: 7061 7273 6572 2e61 6464 5f61 7267 756d  parser.add_argum
-00005790: 656e 7428 0a20 2020 2020 2020 2027 2d2d  ent(.        '--
-000057a0: 7365 7276 6572 2d73 6964 652d 656e 6372  server-side-encr
-000057b0: 7970 7469 6f6e 272c 0a20 2020 2020 2020  yption',.       
-000057c0: 2027 2d2d 656e 6372 7970 7469 6f6e 272c   '--encryption',
-000057d0: 0a20 2020 2020 2020 2064 6573 743d 2765  .        dest='e
-000057e0: 6e63 7279 7074 696f 6e27 2c0a 2020 2020  ncryption',.    
-000057f0: 2020 2020 6163 7469 6f6e 3d27 7374 6f72      action='stor
-00005800: 655f 7472 7565 272c 0a20 2020 2020 2020  e_true',.       
-00005810: 2068 656c 703d 2755 7365 2073 6572 7665   help='Use serve
-00005820: 722d 7369 6465 2d65 6e63 7279 7074 696f  r-side-encryptio
-00005830: 6e20 666f 7220 7175 6572 7920 7265 7375  n for query resu
-00005840: 6c74 7327 0a20 2020 2029 0a20 2020 2070  lts'.    ).    p
-00005850: 6172 7365 722e 6164 645f 6172 6775 6d65  arser.add_argume
-00005860: 6e74 280a 2020 2020 2020 2020 272d 2d76  nt(.        '--v
-00005870: 6572 7369 6f6e 272c 0a20 2020 2020 2020  ersion',.       
-00005880: 2061 6374 696f 6e3d 2773 746f 7265 5f74   action='store_t
-00005890: 7275 6527 2c0a 2020 2020 2020 2020 6865  rue',.        he
-000058a0: 6c70 3d27 7368 6f77 2076 6572 7369 6f6e  lp='show version
-000058b0: 2069 6e66 6f20 616e 6420 6578 6974 270a   info and exit'.
-000058c0: 2020 2020 290a 2020 2020 6172 6773 203d      ).    args =
-000058d0: 2070 6172 7365 722e 7061 7273 655f 6172   parser.parse_ar
-000058e0: 6773 2829 0a0a 2020 2020 6966 2061 7267  gs()..    if arg
-000058f0: 732e 6465 6275 673a 0a20 2020 2020 2020  s.debug:.       
-00005900: 2062 6f74 6f33 2e73 6574 5f73 7472 6561   boto3.set_strea
-00005910: 6d5f 6c6f 6767 6572 286e 616d 653d 2762  m_logger(name='b
-00005920: 6f74 6f63 6f72 6527 290a 0a20 2020 2069  otocore')..    i
-00005930: 6620 6172 6773 2e76 6572 7369 6f6e 3a0a  f args.version:.
-00005940: 2020 2020 2020 2020 7072 696e 7428 2741          print('A
-00005950: 7468 656e 6120 434c 4920 2573 2720 2520  thena CLI %s' % 
-00005960: 5f5f 7665 7273 696f 6e5f 5f29 0a20 2020  __version__).   
-00005970: 2020 2020 2073 7973 2e65 7869 7428 290a       sys.exit().
-00005980: 0a20 2020 2070 726f 6669 6c65 203d 2061  .    profile = a
-00005990: 7267 732e 7072 6f66 696c 6520 6f72 206f  rgs.profile or o
-000059a0: 732e 656e 7669 726f 6e2e 6765 7428 2741  s.environ.get('A
-000059b0: 5753 5f44 4546 4155 4c54 5f50 524f 4649  WS_DEFAULT_PROFI
-000059c0: 4c45 272c 204e 6f6e 6529 206f 7220 6f73  LE', None) or os
-000059d0: 2e65 6e76 6972 6f6e 2e67 6574 2827 4157  .environ.get('AW
-000059e0: 535f 5052 4f46 494c 4527 2c20 4e6f 6e65  S_PROFILE', None
-000059f0: 290a 0a20 2020 2074 7279 3a0a 2020 2020  )..    try:.    
-00005a00: 2020 2020 6174 6865 6e61 203d 2041 7468      athena = Ath
-00005a10: 656e 6128 7072 6f66 696c 652c 2072 6567  ena(profile, reg
-00005a20: 696f 6e3d 6172 6773 2e72 6567 696f 6e2c  ion=args.region,
-00005a30: 2062 7563 6b65 743d 6172 6773 2e62 7563   bucket=args.buc
-00005a40: 6b65 742c 2064 6562 7567 3d61 7267 732e  ket, debug=args.
-00005a50: 6465 6275 672c 2065 6e63 7279 7074 696f  debug, encryptio
-00005a60: 6e3d 6172 6773 2e65 6e63 7279 7074 696f  n=args.encryptio
-00005a70: 6e29 0a20 2020 2065 7863 6570 7420 626f  n).    except bo
-00005a80: 746f 636f 7265 2e65 7863 6570 7469 6f6e  tocore.exception
-00005a90: 732e 436c 6965 6e74 4572 726f 7220 6173  s.ClientError as
-00005aa0: 2065 3a0a 2020 2020 2020 2020 7379 732e   e:.        sys.
-00005ab0: 6578 6974 2865 290a 0a20 2020 2069 6620  exit(e)..    if 
-00005ac0: 6172 6773 2e65 7865 6375 7465 3a0a 2020  args.execute:.  
-00005ad0: 2020 2020 2020 6261 7463 6820 3d20 4174        batch = At
-00005ae0: 6865 6e61 4261 7463 6828 6174 6865 6e61  henaBatch(athena
-00005af0: 2c20 6462 3d61 7267 732e 7363 6865 6d61  , db=args.schema
-00005b00: 2c20 666f 726d 6174 3d61 7267 732e 666f  , format=args.fo
-00005b10: 726d 6174 290a 2020 2020 2020 2020 6261  rmat).        ba
-00005b20: 7463 682e 6578 6563 7574 6528 7374 6174  tch.execute(stat
-00005b30: 656d 656e 743d 6172 6773 2e65 7865 6375  ement=args.execu
-00005b40: 7465 290a 2020 2020 656c 7365 3a0a 2020  te).    else:.  
-00005b50: 2020 2020 2020 7368 656c 6c20 3d20 4174        shell = At
-00005b60: 6865 6e61 5368 656c 6c28 6174 6865 6e61  henaShell(athena
-00005b70: 2c20 6462 3d61 7267 732e 7363 6865 6d61  , db=args.schema
-00005b80: 290a 2020 2020 2020 2020 7368 656c 6c2e  ).        shell.
-00005b90: 636d 646c 6f6f 705f 7769 7468 5f63 616e  cmdloop_with_can
-00005ba0: 6365 6c28 290a 0a69 6620 5f5f 6e61 6d65  cel()..if __name
-00005bb0: 5f5f 203d 3d20 275f 5f6d 6169 6e5f 5f27  __ == '__main__'
-00005bc0: 3a0a 2020 2020 6d61 696e 2829 0a00 0000  :.    main()....
+000026a0: 7265 0a66 726f 6d20 626f 746f 636f 7265  re.from botocore
+000026b0: 2e65 7863 6570 7469 6f6e 7320 696d 706f  .exceptions impo
+000026c0: 7274 2043 6c69 656e 7445 7272 6f72 2c20  rt ClientError, 
+000026d0: 5061 7261 6d56 616c 6964 6174 696f 6e45  ParamValidationE
+000026e0: 7272 6f72 0a66 726f 6d20 636d 6432 2069  rror.from cmd2 i
+000026f0: 6d70 6f72 7420 436d 642c 2075 7469 6c73  mport Cmd, utils
+00002700: 0a66 726f 6d20 7461 6275 6c61 7465 2069  .from tabulate i
+00002710: 6d70 6f72 7420 7461 6275 6c61 7465 0a0a  mport tabulate..
+00002720: 4c45 5353 203d 2022 6c65 7373 202d 4658  LESS = "less -FX
+00002730: 5253 6e22 0a48 4953 544f 5259 5f46 494c  RSn".HISTORY_FIL
+00002740: 455f 5349 5a45 203d 2035 3030 0a0a 5f5f  E_SIZE = 500..__
+00002750: 7665 7273 696f 6e5f 5f20 3d20 2730 2e31  version__ = '0.1
+00002760: 2e38 270a 0a0a 636c 6173 7320 4174 6865  .8'...class Athe
+00002770: 6e61 4261 7463 6828 6f62 6a65 6374 293a  naBatch(object):
+00002780: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00002790: 5f5f 2873 656c 662c 2061 7468 656e 612c  __(self, athena,
+000027a0: 2064 623d 4e6f 6e65 2c20 666f 726d 6174   db=None, format
+000027b0: 3d27 4353 5627 293a 0a20 2020 2020 2020  ='CSV'):.       
+000027c0: 2073 656c 662e 6174 6865 6e61 203d 2061   self.athena = a
+000027d0: 7468 656e 610a 2020 2020 2020 2020 7365  thena.        se
+000027e0: 6c66 2e64 626e 616d 6520 3d20 6462 0a20  lf.dbname = db. 
+000027f0: 2020 2020 2020 2073 656c 662e 666f 726d         self.form
+00002800: 6174 203d 2066 6f72 6d61 740a 0a20 2020  at = format..   
+00002810: 2064 6566 2065 7865 6375 7465 2873 656c   def execute(sel
+00002820: 662c 2073 7461 7465 6d65 6e74 293a 0a20  f, statement):. 
+00002830: 2020 2020 2020 2065 7865 6375 7469 6f6e         execution
+00002840: 5f69 6420 3d20 7365 6c66 2e61 7468 656e  _id = self.athen
+00002850: 612e 7374 6172 745f 7175 6572 795f 6578  a.start_query_ex
+00002860: 6563 7574 696f 6e28 7365 6c66 2e64 626e  ecution(self.dbn
+00002870: 616d 652c 2073 7461 7465 6d65 6e74 290a  ame, statement).
+00002880: 2020 2020 2020 2020 6966 206e 6f74 2065          if not e
+00002890: 7865 6375 7469 6f6e 5f69 643a 0a20 2020  xecution_id:.   
+000028a0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+000028b0: 0a20 2020 2020 2020 2077 6869 6c65 2054  .        while T
+000028c0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
+000028d0: 2073 7461 7473 203d 2073 656c 662e 6174   stats = self.at
+000028e0: 6865 6e61 2e67 6574 5f71 7565 7279 5f65  hena.get_query_e
+000028f0: 7865 6375 7469 6f6e 2865 7865 6375 7469  xecution(executi
+00002900: 6f6e 5f69 6429 0a20 2020 2020 2020 2020  on_id).         
+00002910: 2020 2073 7461 7475 7320 3d20 7374 6174     status = stat
+00002920: 735b 2751 7565 7279 4578 6563 7574 696f  s['QueryExecutio
+00002930: 6e27 5d5b 2753 7461 7475 7327 5d5b 2753  n']['Status']['S
+00002940: 7461 7465 275d 0a20 2020 2020 2020 2020  tate'].         
+00002950: 2020 2069 6620 7374 6174 7573 2069 6e20     if status in 
+00002960: 5b27 5355 4343 4545 4445 4427 2c20 2746  ['SUCCEEDED', 'F
+00002970: 4149 4c45 4427 2c20 2743 414e 4345 4c4c  AILED', 'CANCELL
+00002980: 4544 275d 3a0a 2020 2020 2020 2020 2020  ED']:.          
+00002990: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
+000029a0: 2020 2020 2020 2020 7469 6d65 2e73 6c65          time.sle
+000029b0: 6570 2830 2e32 2920 2023 2032 3030 6d73  ep(0.2)  # 200ms
+000029c0: 0a0a 2020 2020 2020 2020 6966 2073 7461  ..        if sta
+000029d0: 7475 7320 3d3d 2027 5355 4343 4545 4445  tus == 'SUCCEEDE
+000029e0: 4427 3a0a 2020 2020 2020 2020 2020 2020  D':.            
+000029f0: 7265 7375 6c74 7320 3d20 7365 6c66 2e61  results = self.a
+00002a00: 7468 656e 612e 6765 745f 7175 6572 795f  thena.get_query_
+00002a10: 7265 7375 6c74 7328 6578 6563 7574 696f  results(executio
+00002a20: 6e5f 6964 290a 2020 2020 2020 2020 2020  n_id).          
+00002a30: 2020 6865 6164 6572 7320 3d20 5b68 5b27    headers = [h['
+00002a40: 4e61 6d65 275d 2066 6f72 2068 2069 6e20  Name'] for h in 
+00002a50: 7265 7375 6c74 735b 2752 6573 756c 7453  results['ResultS
+00002a60: 6574 275d 5b27 5265 7375 6c74 5365 744d  et']['ResultSetM
+00002a70: 6574 6164 6174 6127 5d5b 2743 6f6c 756d  etadata']['Colum
+00002a80: 6e49 6e66 6f27 5d5d 0a0a 2020 2020 2020  nInfo']]..      
+00002a90: 2020 2020 2020 6966 2073 656c 662e 666f        if self.fo
+00002aa0: 726d 6174 2069 6e20 5b27 4353 5627 2c20  rmat in ['CSV', 
+00002ab0: 2743 5356 5f48 4541 4445 5227 5d3a 0a20  'CSV_HEADER']:. 
+00002ac0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00002ad0: 7376 5f77 7269 7465 7220 3d20 6373 762e  sv_writer = csv.
+00002ae0: 7772 6974 6572 2873 7973 2e73 7464 6f75  writer(sys.stdou
+00002af0: 742c 2071 756f 7469 6e67 3d63 7376 2e51  t, quoting=csv.Q
+00002b00: 554f 5445 5f41 4c4c 290a 2020 2020 2020  UOTE_ALL).      
+00002b10: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00002b20: 662e 666f 726d 6174 203d 3d20 2743 5356  f.format == 'CSV
+00002b30: 5f48 4541 4445 5227 3a0a 2020 2020 2020  _HEADER':.      
+00002b40: 2020 2020 2020 2020 2020 2020 2020 6373                cs
+00002b50: 765f 7772 6974 6572 2e77 7269 7465 726f  v_writer.writero
+00002b60: 7728 6865 6164 6572 7329 0a20 2020 2020  w(headers).     
+00002b70: 2020 2020 2020 2020 2020 2063 7376 5f77             csv_w
+00002b80: 7269 7465 722e 7772 6974 6572 6f77 7328  riter.writerows(
+00002b90: 5b72 6f77 2066 6f72 2072 6f77 2069 6e20  [row for row in 
+00002ba0: 7365 6c66 2e61 7468 656e 612e 7969 656c  self.athena.yiel
+00002bb0: 645f 726f 7773 2872 6573 756c 7473 2c20  d_rows(results, 
+00002bc0: 6865 6164 6572 7329 5d29 0a20 2020 2020  headers)]).     
+00002bd0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00002be0: 2e66 6f72 6d61 7420 3d3d 2027 5453 5627  .format == 'TSV'
+00002bf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00002c00: 2020 7072 696e 7428 7461 6275 6c61 7465    print(tabulate
+00002c10: 285b 726f 7720 666f 7220 726f 7720 696e  ([row for row in
+00002c20: 2073 656c 662e 6174 6865 6e61 2e79 6965   self.athena.yie
+00002c30: 6c64 5f72 6f77 7328 7265 7375 6c74 732c  ld_rows(results,
+00002c40: 2068 6561 6465 7273 295d 2c20 7461 626c   headers)], tabl
+00002c50: 6566 6d74 3d27 7473 7627 2929 0a20 2020  efmt='tsv')).   
+00002c60: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+00002c70: 6c66 2e66 6f72 6d61 7420 3d3d 2027 5453  lf.format == 'TS
+00002c80: 565f 4845 4144 4552 273a 0a20 2020 2020  V_HEADER':.     
+00002c90: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00002ca0: 2874 6162 756c 6174 6528 5b72 6f77 2066  (tabulate([row f
+00002cb0: 6f72 2072 6f77 2069 6e20 7365 6c66 2e61  or row in self.a
+00002cc0: 7468 656e 612e 7969 656c 645f 726f 7773  thena.yield_rows
+00002cd0: 2872 6573 756c 7473 2c20 6865 6164 6572  (results, header
+00002ce0: 7329 5d2c 2068 6561 6465 7273 3d68 6561  s)], headers=hea
+00002cf0: 6465 7273 2c20 7461 626c 6566 6d74 3d27  ders, tablefmt='
+00002d00: 7473 7627 2929 0a20 2020 2020 2020 2020  tsv')).         
+00002d10: 2020 2065 6c69 6620 7365 6c66 2e66 6f72     elif self.for
+00002d20: 6d61 7420 3d3d 2027 5645 5254 4943 414c  mat == 'VERTICAL
+00002d30: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+00002d40: 2020 2066 6f72 206e 756d 2c20 726f 7720     for num, row 
+00002d50: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
+00002d60: 662e 6174 6865 6e61 2e79 6965 6c64 5f72  f.athena.yield_r
+00002d70: 6f77 7328 7265 7375 6c74 732c 2068 6561  ows(results, hea
+00002d80: 6465 7273 2929 3a0a 2020 2020 2020 2020  ders)):.        
+00002d90: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00002da0: 7428 272d 2d5b 5245 434f 5244 207b 7d5d  t('--[RECORD {}]
+00002db0: 2d2d 272e 666f 726d 6174 286e 756d 2b31  --'.format(num+1
+00002dc0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00002dd0: 2020 2020 2020 2070 7269 6e74 2874 6162         print(tab
+00002de0: 756c 6174 6528 7a69 7028 2a5b 6865 6164  ulate(zip(*[head
+00002df0: 6572 732c 2072 6f77 5d29 2c20 7461 626c  ers, row]), tabl
+00002e00: 6566 6d74 3d27 7072 6573 746f 2729 290a  efmt='presto')).
+00002e10: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00002e20: 3a20 2023 2041 4c49 474e 4544 0a20 2020  :  # ALIGNED.   
+00002e30: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00002e40: 6e74 2874 6162 756c 6174 6528 5b78 2066  nt(tabulate([x f
+00002e50: 6f72 2078 2069 6e20 7365 6c66 2e61 7468  or x in self.ath
+00002e60: 656e 612e 7969 656c 645f 726f 7773 2872  ena.yield_rows(r
+00002e70: 6573 756c 7473 2c20 6865 6164 6572 7329  esults, headers)
+00002e80: 5d2c 2068 6561 6465 7273 3d68 6561 6465  ], headers=heade
+00002e90: 7273 2c20 7461 626c 6566 6d74 3d27 7072  rs, tablefmt='pr
+00002ea0: 6573 746f 2729 290a 0a20 2020 2020 2020  esto'))..       
+00002eb0: 2069 6620 7374 6174 7573 203d 3d20 2746   if status == 'F
+00002ec0: 4149 4c45 4427 3a0a 2020 2020 2020 2020  AILED':.        
+00002ed0: 2020 2020 7072 696e 7428 7374 6174 735b      print(stats[
+00002ee0: 2751 7565 7279 4578 6563 7574 696f 6e27  'QueryExecution'
+00002ef0: 5d5b 2753 7461 7475 7327 5d5b 2753 7461  ]['Status']['Sta
+00002f00: 7465 4368 616e 6765 5265 6173 6f6e 275d  teChangeReason']
+00002f10: 290a 0a0a 636c 6173 7320 4174 6865 6e61  )...class Athena
+00002f20: 5368 656c 6c28 436d 642c 206f 626a 6563  Shell(Cmd, objec
+00002f30: 7429 3a0a 0a20 2020 206d 756c 7469 6c69  t):..    multili
+00002f40: 6e65 5f63 6f6d 6d61 6e64 7320 3d20 5b27  ne_commands = ['
+00002f50: 5749 5448 272c 2027 5345 4c45 4354 272c  WITH', 'SELECT',
+00002f60: 2027 414c 5445 5227 2c20 2743 5245 4154   'ALTER', 'CREAT
+00002f70: 4527 2c20 2744 4553 4352 4942 4527 2c20  E', 'DESCRIBE', 
+00002f80: 2744 524f 5027 2c20 274d 5343 4b27 2c20  'DROP', 'MSCK', 
+00002f90: 2753 484f 5727 2c20 2755 5345 272c 2027  'SHOW', 'USE', '
+00002fa0: 5641 4c55 4553 275d 0a0a 2020 2020 6465  VALUES']..    de
+00002fb0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00002fc0: 2061 7468 656e 612c 2064 623d 4e6f 6e65   athena, db=None
+00002fd0: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+00002fe0: 2829 2e5f 5f69 6e69 745f 5f28 6d75 6c74  ().__init__(mult
+00002ff0: 696c 696e 655f 636f 6d6d 616e 6473 3d41  iline_commands=A
+00003000: 7468 656e 6153 6865 6c6c 2e6d 756c 7469  thenaShell.multi
+00003010: 6c69 6e65 5f63 6f6d 6d61 6e64 7329 0a0a  line_commands)..
+00003020: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
+00003030: 6f77 5f63 6c69 5f61 7267 7320 3d20 4661  ow_cli_args = Fa
+00003040: 6c73 650a 0a20 2020 2020 2020 2073 656c  lse..        sel
+00003050: 662e 6174 6865 6e61 203d 2061 7468 656e  f.athena = athen
+00003060: 610a 2020 2020 2020 2020 7365 6c66 2e64  a.        self.d
+00003070: 626e 616d 6520 3d20 6462 0a0a 2020 2020  bname = db..    
+00003080: 2020 2020 7365 6c66 2e65 7865 6375 7469      self.executi
+00003090: 6f6e 5f69 6420 3d20 4e6f 6e65 0a0a 2020  on_id = None..  
+000030a0: 2020 2020 2020 7365 6c66 2e72 6f77 5f63        self.row_c
+000030b0: 6f75 6e74 203d 2030 0a0a 2020 2020 2020  ount = 0..      
+000030c0: 2020 7365 6c66 2e73 6574 5f70 726f 6d70    self.set_promp
+000030d0: 7428 290a 2020 2020 2020 2020 7365 6c66  t().        self
+000030e0: 2e70 6167 6572 203d 206f 732e 656e 7669  .pager = os.envi
+000030f0: 726f 6e2e 6765 7428 2741 5448 454e 415f  ron.get('ATHENA_
+00003100: 434c 495f 5041 4745 5227 2c20 4c45 5353  CLI_PAGER', LESS
+00003110: 292e 7370 6c69 7428 2720 2729 0a0a 2020  ).split(' ')..  
+00003120: 2020 2020 2020 7365 6c66 2e68 6973 745f        self.hist_
+00003130: 6669 6c65 203d 206f 732e 7061 7468 2e6a  file = os.path.j
+00003140: 6f69 6e28 6f73 2e70 6174 682e 6578 7061  oin(os.path.expa
+00003150: 6e64 7573 6572 2822 7e22 292c 2022 2e61  nduser("~"), ".a
+00003160: 7468 656e 615f 6869 7374 6f72 7922 290a  thena_history").
+00003170: 2020 2020 2020 2020 7365 6c66 2e69 6e69          self.ini
+00003180: 745f 6869 7374 6f72 7928 290a 0a20 2020  t_history()..   
+00003190: 2064 6566 2073 6574 5f70 726f 6d70 7428   def set_prompt(
+000031a0: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
+000031b0: 656c 662e 7072 6f6d 7074 203d 2027 6174  elf.prompt = 'at
+000031c0: 6865 6e61 3a25 733e 2027 2025 2073 656c  hena:%s> ' % sel
+000031d0: 662e 6462 6e61 6d65 2069 6620 7365 6c66  f.dbname if self
+000031e0: 2e64 626e 616d 6520 656c 7365 2027 6174  .dbname else 'at
+000031f0: 6865 6e61 3e20 270a 0a20 2020 2064 6566  hena> '..    def
+00003200: 2063 6d64 6c6f 6f70 5f77 6974 685f 6361   cmdloop_with_ca
+00003210: 6e63 656c 2873 656c 662c 2069 6e74 726f  ncel(self, intro
+00003220: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00003230: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00003240: 2073 656c 662e 636d 646c 6f6f 7028 696e   self.cmdloop(in
+00003250: 7472 6f29 0a20 2020 2020 2020 2065 7863  tro).        exc
+00003260: 6570 7420 4b65 7962 6f61 7264 496e 7465  ept KeyboardInte
+00003270: 7272 7570 743a 0a20 2020 2020 2020 2020  rrupt:.         
+00003280: 2020 2069 6620 7365 6c66 2e65 7865 6375     if self.execu
+00003290: 7469 6f6e 5f69 643a 0a20 2020 2020 2020  tion_id:.       
+000032a0: 2020 2020 2020 2020 2073 656c 662e 6174           self.at
+000032b0: 6865 6e61 2e73 746f 705f 7175 6572 795f  hena.stop_query_
+000032c0: 6578 6563 7574 696f 6e28 7365 6c66 2e65  execution(self.e
+000032d0: 7865 6375 7469 6f6e 5f69 6429 0a20 2020  xecution_id).   
+000032e0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000032f0: 6e74 2827 5c6e 5c6e 2573 2720 2520 7365  nt('\n\n%s' % se
+00003300: 6c66 2e61 7468 656e 612e 636f 6e73 6f6c  lf.athena.consol
+00003310: 655f 6c69 6e6b 2873 656c 662e 6578 6563  e_link(self.exec
+00003320: 7574 696f 6e5f 6964 2929 0a20 2020 2020  ution_id)).     
+00003330: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00003340: 2827 5c6e 5175 6572 7920 6162 6f72 7465  ('\nQuery aborte
+00003350: 6420 6279 2075 7365 7227 290a 2020 2020  d by user').    
+00003360: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00003370: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00003380: 696e 7428 275c 7227 290a 2020 2020 2020  int('\r').      
+00003390: 2020 2020 2020 7365 6c66 2e63 6d64 6c6f        self.cmdlo
+000033a0: 6f70 5f77 6974 685f 6361 6e63 656c 2869  op_with_cancel(i
+000033b0: 6e74 726f 290a 0a20 2020 2064 6566 2070  ntro)..    def p
+000033c0: 7265 6c6f 6f70 2873 656c 6629 3a0a 2020  reloop(self):.  
+000033d0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
+000033e0: 2e65 7869 7374 7328 7365 6c66 2e68 6973  .exists(self.his
+000033f0: 745f 6669 6c65 293a 0a20 2020 2020 2020  t_file):.       
+00003400: 2020 2020 2072 6561 646c 696e 652e 7265       readline.re
+00003410: 6164 5f68 6973 746f 7279 5f66 696c 6528  ad_history_file(
+00003420: 7365 6c66 2e68 6973 745f 6669 6c65 290a  self.hist_file).
+00003430: 0a20 2020 2064 6566 2070 6f73 746c 6f6f  .    def postloo
+00003440: 7028 7365 6c66 293a 0a20 2020 2020 2020  p(self):.       
+00003450: 2073 656c 662e 7361 7665 5f68 6973 746f   self.save_histo
+00003460: 7279 2829 0a0a 2020 2020 6465 6620 696e  ry()..    def in
+00003470: 6974 5f68 6973 746f 7279 2873 656c 6629  it_history(self)
+00003480: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+00003490: 2020 2020 2020 2020 2020 2072 6561 646c             readl
+000034a0: 696e 652e 7265 6164 5f68 6973 746f 7279  ine.read_history
+000034b0: 5f66 696c 6528 7365 6c66 2e68 6973 745f  _file(self.hist_
+000034c0: 6669 6c65 290a 2020 2020 2020 2020 2020  file).          
+000034d0: 2020 7265 6164 6c69 6e65 2e73 6574 5f68    readline.set_h
+000034e0: 6973 746f 7279 5f6c 656e 6774 6828 4849  istory_length(HI
+000034f0: 5354 4f52 595f 4649 4c45 5f53 495a 4529  STORY_FILE_SIZE)
+00003500: 0a20 2020 2020 2020 2020 2020 2072 6561  .            rea
+00003510: 646c 696e 652e 7772 6974 655f 6869 7374  dline.write_hist
+00003520: 6f72 795f 6669 6c65 2873 656c 662e 6869  ory_file(self.hi
+00003530: 7374 5f66 696c 6529 0a20 2020 2020 2020  st_file).       
+00003540: 2065 7863 6570 7420 494f 4572 726f 723a   except IOError:
+00003550: 0a20 2020 2020 2020 2020 2020 2072 6561  .            rea
+00003560: 646c 696e 652e 7772 6974 655f 6869 7374  dline.write_hist
+00003570: 6f72 795f 6669 6c65 2873 656c 662e 6869  ory_file(self.hi
+00003580: 7374 5f66 696c 6529 0a0a 2020 2020 2020  st_file)..      
+00003590: 2020 6174 6578 6974 2e72 6567 6973 7465    atexit.registe
+000035a0: 7228 7365 6c66 2e73 6176 655f 6869 7374  r(self.save_hist
+000035b0: 6f72 7929 0a0a 2020 2020 6465 6620 7361  ory)..    def sa
+000035c0: 7665 5f68 6973 746f 7279 2873 656c 6629  ve_history(self)
+000035d0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+000035e0: 2020 2020 2020 2020 2020 2072 6561 646c             readl
+000035f0: 696e 652e 7772 6974 655f 6869 7374 6f72  ine.write_histor
+00003600: 795f 6669 6c65 2873 656c 662e 6869 7374  y_file(self.hist
+00003610: 5f66 696c 6529 0a20 2020 2020 2020 2065  _file).        e
+00003620: 7863 6570 7420 494f 4572 726f 723a 0a20  xcept IOError:. 
+00003630: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+00003640: 0a20 2020 2064 6566 2064 6f5f 6865 6c70  .    def do_help
+00003650: 2873 656c 662c 2061 7267 293a 0a20 2020  (self, arg):.   
+00003660: 2020 2020 2068 656c 705f 6f75 7470 7574       help_output
+00003670: 203d 2022 2222 0a53 7570 706f 7274 6564   = """.Supported
+00003680: 2063 6f6d 6d61 6e64 733a 0a51 5549 540a   commands:.QUIT.
+00003690: 5345 4c45 4354 0a41 4c54 4552 2044 4154  SELECT.ALTER DAT
+000036a0: 4142 4153 4520 3c73 6368 656d 613e 0a41  ABASE <schema>.A
+000036b0: 4c54 4552 2054 4142 4c45 203c 7461 626c  LTER TABLE <tabl
+000036c0: 653e 0a43 5245 4154 4520 4441 5441 4241  e>.CREATE DATABA
+000036d0: 5345 203c 7363 6865 6d61 3e0a 4352 4541  SE <schema>.CREA
+000036e0: 5445 2054 4142 4c45 203c 7461 626c 653e  TE TABLE <table>
+000036f0: 0a44 4553 4352 4942 4520 3c74 6162 6c65  .DESCRIBE <table
+00003700: 3e0a 4452 4f50 2044 4154 4142 4153 4520  >.DROP DATABASE 
+00003710: 3c73 6368 656d 613e 0a44 524f 5020 5441  <schema>.DROP TA
+00003720: 424c 4520 3c74 6162 6c65 3e0a 4d53 434b  BLE <table>.MSCK
+00003730: 2052 4550 4149 5220 5441 424c 4520 3c74   REPAIR TABLE <t
+00003740: 6162 6c65 3e0a 5348 4f57 2043 4f4c 554d  able>.SHOW COLUM
+00003750: 4e53 2046 524f 4d20 3c74 6162 6c65 3e0a  NS FROM <table>.
+00003760: 5348 4f57 2043 5245 4154 4520 5441 424c  SHOW CREATE TABL
+00003770: 4520 3c74 6162 6c65 3e0a 5348 4f57 2044  E <table>.SHOW D
+00003780: 4154 4142 4153 4553 205b 4c49 4b45 203c  ATABASES [LIKE <
+00003790: 7061 7474 6572 6e3e 5d0a 5348 4f57 2050  pattern>].SHOW P
+000037a0: 4152 5449 5449 4f4e 5320 3c74 6162 6c65  ARTITIONS <table
+000037b0: 3e0a 5348 4f57 2054 4142 4c45 5320 5b49  >.SHOW TABLES [I
+000037c0: 4e20 3c73 6368 656d 613e 5d20 5b3c 7061  N <schema>] [<pa
+000037d0: 7474 6572 6e3e 5d0a 5348 4f57 2054 424c  ttern>].SHOW TBL
+000037e0: 5052 4f50 4552 5449 4553 203c 7461 626c  PROPERTIES <tabl
+000037f0: 653e 0a55 5345 205b 3c63 6174 616c 6f67  e>.USE [<catalog
+00003800: 3e2e 5d3c 7363 6865 6d61 3e0a 5641 4c55  >.]<schema>.VALU
+00003810: 4553 2072 6f77 205b 2c20 2e2e 2e5d 0a0a  ES row [, ...]..
+00003820: 5365 6520 6874 7470 3a2f 2f64 6f63 732e  See http://docs.
+00003830: 6177 732e 616d 617a 6f6e 2e63 6f6d 2f61  aws.amazon.com/a
+00003840: 7468 656e 612f 6c61 7465 7374 2f75 672f  thena/latest/ug/
+00003850: 6c61 6e67 7561 6765 2d72 6566 6572 656e  language-referen
+00003860: 6365 2e68 746d 6c0a 2222 220a 2020 2020  ce.html.""".    
+00003870: 2020 2020 7072 696e 7428 6865 6c70 5f6f      print(help_o
+00003880: 7574 7075 7429 0a0a 2020 2020 6465 6620  utput)..    def 
+00003890: 646f 5f71 7569 7428 7365 6c66 2c20 6172  do_quit(self, ar
+000038a0: 6729 3a0a 2020 2020 2020 2020 7072 696e  g):.        prin
+000038b0: 7428 290a 2020 2020 2020 2020 7265 7475  t().        retu
+000038c0: 726e 202d 310a 0a20 2020 2064 6566 2064  rn -1..    def d
+000038d0: 6f5f 454f 4628 7365 6c66 2c20 6172 6729  o_EOF(self, arg)
+000038e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000038f0: 2073 656c 662e 646f 5f71 7569 7428 6172   self.do_quit(ar
+00003900: 6729 0a0a 2020 2020 6465 6620 646f 5f75  g)..    def do_u
+00003910: 7365 2873 656c 662c 2073 6368 656d 6129  se(self, schema)
+00003920: 3a0a 2020 2020 2020 2020 7365 6c66 2e64  :.        self.d
+00003930: 626e 616d 6520 3d20 7363 6865 6d61 2e72  bname = schema.r
+00003940: 7374 7269 7028 273b 2729 0a20 2020 2020  strip(';').     
+00003950: 2020 2073 656c 662e 7365 745f 7072 6f6d     self.set_prom
+00003960: 7074 2829 0a0a 2020 2020 6465 6620 646f  pt()..    def do
+00003970: 5f73 6574 2873 656c 662c 2061 7267 293a  _set(self, arg):
+00003980: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00003990: 2020 2020 2020 2020 2020 7374 6174 656d            statem
+000039a0: 656e 742c 2070 6172 616d 5f6e 616d 652c  ent, param_name,
+000039b0: 2076 616c 203d 2061 7267 2e70 6172 7365   val = arg.parse
+000039c0: 642e 7261 772e 7370 6c69 7428 4e6f 6e65  d.raw.split(None
+000039d0: 2c20 3229 0a20 2020 2020 2020 2020 2020  , 2).           
+000039e0: 2076 616c 203d 2076 616c 2e73 7472 6970   val = val.strip
+000039f0: 2829 0a20 2020 2020 2020 2020 2020 2070  ().            p
+00003a00: 6172 616d 5f6e 616d 6520 3d20 7061 7261  aram_name = para
+00003a10: 6d5f 6e61 6d65 2e73 7472 6970 2829 2e6c  m_name.strip().l
+00003a20: 6f77 6572 2829 0a20 2020 2020 2020 2020  ower().         
+00003a30: 2020 2069 6620 7061 7261 6d5f 6e61 6d65     if param_name
+00003a40: 203d 3d20 2764 6562 7567 273a 0a20 2020   == 'debug':.   
+00003a50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00003a60: 662e 6174 6865 6e61 2e64 6562 7567 203d  f.athena.debug =
+00003a70: 2075 7469 6c73 2e63 6173 7428 5472 7565   utils.cast(True
+00003a80: 2c20 7661 6c29 0a20 2020 2020 2020 2065  , val).        e
+00003a90: 7863 6570 7420 2856 616c 7565 4572 726f  xcept (ValueErro
+00003aa0: 722c 2041 7474 7269 6275 7465 4572 726f  r, AttributeErro
+00003ab0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00003ac0: 7365 6c66 2e64 6f5f 6865 6c70 2861 7267  self.do_help(arg
+00003ad0: 290a 2020 2020 2020 2020 7375 7065 7228  ).        super(
+00003ae0: 292e 646f 5f73 6574 2861 7267 290a 0a20  ).do_set(arg).. 
+00003af0: 2020 2064 6566 2064 6566 6175 6c74 2873     def default(s
+00003b00: 656c 662c 206c 696e 6529 3a0a 2020 2020  elf, line):.    
+00003b10: 2020 2020 7365 6c66 2e65 7865 6375 7469      self.executi
+00003b20: 6f6e 5f69 6420 3d20 7365 6c66 2e61 7468  on_id = self.ath
+00003b30: 656e 612e 7374 6172 745f 7175 6572 795f  ena.start_query_
+00003b40: 6578 6563 7574 696f 6e28 7365 6c66 2e64  execution(self.d
+00003b50: 626e 616d 652c 206c 696e 652e 636f 6d6d  bname, line.comm
+00003b60: 616e 645f 616e 645f 6172 6773 290a 2020  and_and_args).  
+00003b70: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00003b80: 662e 6578 6563 7574 696f 6e5f 6964 3a0a  f.execution_id:.
+00003b90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00003ba0: 726e 0a0a 2020 2020 2020 2020 7768 696c  rn..        whil
+00003bb0: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
+00003bc0: 2020 2020 7374 6174 7320 3d20 7365 6c66      stats = self
+00003bd0: 2e61 7468 656e 612e 6765 745f 7175 6572  .athena.get_quer
+00003be0: 795f 6578 6563 7574 696f 6e28 7365 6c66  y_execution(self
+00003bf0: 2e65 7865 6375 7469 6f6e 5f69 6429 0a20  .execution_id). 
+00003c00: 2020 2020 2020 2020 2020 2073 7461 7475             statu
+00003c10: 7320 3d20 7374 6174 735b 2751 7565 7279  s = stats['Query
+00003c20: 4578 6563 7574 696f 6e27 5d5b 2753 7461  Execution']['Sta
+00003c30: 7475 7327 5d5b 2753 7461 7465 275d 0a20  tus']['State']. 
+00003c40: 2020 2020 2020 2020 2020 2073 7461 7475             statu
+00003c50: 735f 6c69 6e65 203d 2027 5175 6572 7920  s_line = 'Query 
+00003c60: 7b30 7d2c 207b 313a 397d 272e 666f 726d  {0}, {1:9}'.form
+00003c70: 6174 2873 656c 662e 6578 6563 7574 696f  at(self.executio
+00003c80: 6e5f 6964 2c20 7374 6174 7573 290a 2020  n_id, status).  
+00003c90: 2020 2020 2020 2020 2020 7379 732e 7374            sys.st
+00003ca0: 646f 7574 2e77 7269 7465 2827 5c72 2720  dout.write('\r' 
+00003cb0: 2b20 7374 6174 7573 5f6c 696e 6529 0a20  + status_line). 
+00003cc0: 2020 2020 2020 2020 2020 2073 7973 2e73             sys.s
+00003cd0: 7464 6f75 742e 666c 7573 6828 290a 2020  tdout.flush().  
+00003ce0: 2020 2020 2020 2020 2020 6966 2073 7461            if sta
+00003cf0: 7475 7320 696e 205b 2753 5543 4345 4544  tus in ['SUCCEED
+00003d00: 4544 272c 2027 4641 494c 4544 272c 2027  ED', 'FAILED', '
+00003d10: 4341 4e43 454c 4c45 4427 5d3a 0a20 2020  CANCELLED']:.   
+00003d20: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+00003d30: 616b 0a20 2020 2020 2020 2020 2020 2074  ak.            t
+00003d40: 696d 652e 736c 6565 7028 302e 3229 2020  ime.sleep(0.2)  
+00003d50: 2320 3230 306d 730a 0a20 2020 2020 2020  # 200ms..       
+00003d60: 2073 7973 2e73 7464 6f75 742e 7772 6974   sys.stdout.writ
+00003d70: 6528 275c 7227 202b 2027 2027 202a 206c  e('\r' + ' ' * l
+00003d80: 656e 2873 7461 7475 735f 6c69 6e65 2920  en(status_line) 
+00003d90: 2b20 275c 7227 2920 2023 2064 656c 6574  + '\r')  # delet
+00003da0: 6520 7175 6572 7920 7374 6174 7573 206c  e query status l
+00003db0: 696e 650a 2020 2020 2020 2020 7379 732e  ine.        sys.
+00003dc0: 7374 646f 7574 2e66 6c75 7368 2829 0a0a  stdout.flush()..
+00003dd0: 2020 2020 2020 2020 6966 2073 7461 7475          if statu
+00003de0: 7320 3d3d 2027 5355 4343 4545 4445 4427  s == 'SUCCEEDED'
+00003df0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00003e00: 7375 6c74 7320 3d20 7365 6c66 2e61 7468  sults = self.ath
+00003e10: 656e 612e 6765 745f 7175 6572 795f 7265  ena.get_query_re
+00003e20: 7375 6c74 7328 7365 6c66 2e65 7865 6375  sults(self.execu
+00003e30: 7469 6f6e 5f69 6429 0a20 2020 2020 2020  tion_id).       
+00003e40: 2020 2020 2068 6561 6465 7273 203d 205b       headers = [
+00003e50: 685b 274e 616d 6527 5d20 666f 7220 6820  h['Name'] for h 
+00003e60: 696e 2072 6573 756c 7473 5b27 5265 7375  in results['Resu
+00003e70: 6c74 5365 7427 5d5b 2752 6573 756c 7453  ltSet']['ResultS
+00003e80: 6574 4d65 7461 6461 7461 275d 5b27 436f  etMetadata']['Co
+00003e90: 6c75 6d6e 496e 666f 275d 5d0a 2020 2020  lumnInfo']].    
+00003ea0: 2020 2020 2020 2020 726f 775f 636f 756e          row_coun
+00003eb0: 7420 3d20 6c65 6e28 7265 7375 6c74 735b  t = len(results[
+00003ec0: 2752 6573 756c 7453 6574 275d 5b27 526f  'ResultSet']['Ro
+00003ed0: 7773 275d 290a 0a20 2020 2020 2020 2020  ws'])..         
+00003ee0: 2020 2069 6620 6865 6164 6572 7320 616e     if headers an
+00003ef0: 6420 6c65 6e28 7265 7375 6c74 735b 2752  d len(results['R
+00003f00: 6573 756c 7453 6574 275d 5b27 526f 7773  esultSet']['Rows
+00003f10: 275d 2920 616e 6420 7265 7375 6c74 735b  ']) and results[
+00003f20: 2752 6573 756c 7453 6574 275d 5b27 526f  'ResultSet']['Ro
+00003f30: 7773 275d 5b30 5d5b 2744 6174 6127 5d5b  ws'][0]['Data'][
+00003f40: 305d 2e67 6574 2827 5661 7243 6861 7256  0].get('VarCharV
+00003f50: 616c 7565 272c 204e 6f6e 6529 203d 3d20  alue', None) == 
+00003f60: 6865 6164 6572 735b 305d 3a0a 2020 2020  headers[0]:.    
+00003f70: 2020 2020 2020 2020 2020 2020 726f 775f              row_
+00003f80: 636f 756e 7420 2d3d 2031 2020 2320 646f  count -= 1  # do
+00003f90: 6e27 7420 636f 756e 7420 6865 6164 6572  n't count header
+00003fa0: 0a0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00003fb0: 6f63 6573 7320 3d20 7375 6270 726f 6365  ocess = subproce
+00003fc0: 7373 2e50 6f70 656e 2873 656c 662e 7061  ss.Popen(self.pa
+00003fd0: 6765 722c 2073 7464 696e 3d73 7562 7072  ger, stdin=subpr
+00003fe0: 6f63 6573 732e 5049 5045 290a 2020 2020  ocess.PIPE).    
+00003ff0: 2020 2020 2020 2020 7072 6f63 6573 732e          process.
+00004000: 7374 6469 6e2e 7772 6974 6528 7461 6275  stdin.write(tabu
+00004010: 6c61 7465 285b 7820 666f 7220 7820 696e  late([x for x in
+00004020: 2073 656c 662e 6174 6865 6e61 2e79 6965   self.athena.yie
+00004030: 6c64 5f72 6f77 7328 7265 7375 6c74 732c  ld_rows(results,
+00004040: 2068 6561 6465 7273 295d 2c20 6865 6164   headers)], head
+00004050: 6572 733d 6865 6164 6572 732c 2074 6162  ers=headers, tab
+00004060: 6c65 666d 743d 2770 7265 7374 6f27 292e  lefmt='presto').
+00004070: 656e 636f 6465 2827 7574 662d 3827 2929  encode('utf-8'))
+00004080: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00004090: 6365 7373 2e63 6f6d 6d75 6e69 6361 7465  cess.communicate
+000040a0: 2829 0a20 2020 2020 2020 2020 2020 2070  ().            p
+000040b0: 7269 6e74 2827 2825 7320 726f 7773 295c  rint('(%s rows)\
+000040c0: 6e27 2025 2072 6f77 5f63 6f75 6e74 290a  n' % row_count).
+000040d0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+000040e0: 5175 6572 7920 7b30 7d2c 207b 317d 272e  Query {0}, {1}'.
+000040f0: 666f 726d 6174 2873 656c 662e 6578 6563  format(self.exec
+00004100: 7574 696f 6e5f 6964 2c20 7374 6174 7573  ution_id, status
+00004110: 2929 0a20 2020 2020 2020 2069 6620 7374  )).        if st
+00004120: 6174 7573 203d 3d20 2746 4149 4c45 4427  atus == 'FAILED'
+00004130: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00004140: 696e 7428 7374 6174 735b 2751 7565 7279  int(stats['Query
+00004150: 4578 6563 7574 696f 6e27 5d5b 2753 7461  Execution']['Sta
+00004160: 7475 7327 5d5b 2753 7461 7465 4368 616e  tus']['StateChan
+00004170: 6765 5265 6173 6f6e 275d 290a 2020 2020  geReason']).    
+00004180: 2020 2020 7072 696e 7428 7365 6c66 2e61      print(self.a
+00004190: 7468 656e 612e 636f 6e73 6f6c 655f 6c69  thena.console_li
+000041a0: 6e6b 2873 656c 662e 6578 6563 7574 696f  nk(self.executio
+000041b0: 6e5f 6964 2929 0a0a 2020 2020 2020 2020  n_id))..        
+000041c0: 7375 626d 6973 7369 6f6e 5f64 6174 6520  submission_date 
+000041d0: 3d20 7374 6174 735b 2751 7565 7279 4578  = stats['QueryEx
+000041e0: 6563 7574 696f 6e27 5d5b 2753 7461 7475  ecution']['Statu
+000041f0: 7327 5d5b 2753 7562 6d69 7373 696f 6e44  s']['SubmissionD
+00004200: 6174 6554 696d 6527 5d0a 2020 2020 2020  ateTime'].      
+00004210: 2020 636f 6d70 6c65 7469 6f6e 5f64 6174    completion_dat
+00004220: 6520 3d20 7374 6174 735b 2751 7565 7279  e = stats['Query
+00004230: 4578 6563 7574 696f 6e27 5d5b 2753 7461  Execution']['Sta
+00004240: 7475 7327 5d5b 2743 6f6d 706c 6574 696f  tus']['Completio
+00004250: 6e44 6174 6554 696d 6527 5d0a 2020 2020  nDateTime'].    
+00004260: 2020 2020 6578 6563 7574 696f 6e5f 7469      execution_ti
+00004270: 6d65 203d 2073 7461 7473 5b27 5175 6572  me = stats['Quer
+00004280: 7945 7865 6375 7469 6f6e 275d 5b27 5374  yExecution']['St
+00004290: 6174 6973 7469 6373 275d 5b27 456e 6769  atistics']['Engi
+000042a0: 6e65 4578 6563 7574 696f 6e54 696d 6549  neExecutionTimeI
+000042b0: 6e4d 696c 6c69 7327 5d0a 2020 2020 2020  nMillis'].      
+000042c0: 2020 6461 7461 5f73 6361 6e6e 6564 203d    data_scanned =
+000042d0: 2073 7461 7473 5b27 5175 6572 7945 7865   stats['QueryExe
+000042e0: 6375 7469 6f6e 275d 5b27 5374 6174 6973  cution']['Statis
+000042f0: 7469 6373 275d 5b27 4461 7461 5363 616e  tics']['DataScan
+00004300: 6e65 6449 6e42 7974 6573 275d 0a20 2020  nedInBytes'].   
+00004310: 2020 2020 2071 7565 7279 5f63 6f73 7420       query_cost 
+00004320: 3d20 6461 7461 5f73 6361 6e6e 6564 202f  = data_scanned /
+00004330: 2031 3030 3030 3030 3030 3030 3030 2e30   1000000000000.0
+00004340: 202a 2035 2e30 0a0a 2020 2020 2020 2020   * 5.0..        
+00004350: 7072 696e 7428 2754 696d 653a 207b 7d2c  print('Time: {},
+00004360: 2043 5055 2054 696d 653a 207b 7d6d 7320   CPU Time: {}ms 
+00004370: 746f 7461 6c2c 2044 6174 6120 5363 616e  total, Data Scan
+00004380: 6e65 643a 207b 7d2c 2043 6f73 743a 2024  ned: {}, Cost: $
+00004390: 7b3a 2c2e 3266 7d5c 6e27 2e66 6f72 6d61  {:,.2f}\n'.forma
+000043a0: 7428 0a20 2020 2020 2020 2020 2020 2073  t(.            s
+000043b0: 7472 2863 6f6d 706c 6574 696f 6e5f 6461  tr(completion_da
+000043c0: 7465 202d 2073 7562 6d69 7373 696f 6e5f  te - submission_
+000043d0: 6461 7465 292e 7370 6c69 7428 272e 2729  date).split('.')
+000043e0: 5b30 5d2c 0a20 2020 2020 2020 2020 2020  [0],.           
+000043f0: 2065 7865 6375 7469 6f6e 5f74 696d 652c   execution_time,
+00004400: 0a20 2020 2020 2020 2020 2020 2068 756d  .            hum
+00004410: 616e 5f72 6561 6461 626c 6528 6461 7461  an_readable(data
+00004420: 5f73 6361 6e6e 6564 292c 0a20 2020 2020  _scanned),.     
+00004430: 2020 2020 2020 2071 7565 7279 5f63 6f73         query_cos
+00004440: 740a 2020 2020 2020 2020 2929 0a0a 0a63  t.        ))...c
+00004450: 6c61 7373 2041 7468 656e 6128 6f62 6a65  lass Athena(obje
+00004460: 6374 293a 0a0a 2020 2020 6465 6620 5f5f  ct):..    def __
+00004470: 696e 6974 5f5f 2873 656c 662c 2070 726f  init__(self, pro
+00004480: 6669 6c65 2c20 7265 6769 6f6e 3d4e 6f6e  file, region=Non
+00004490: 652c 2062 7563 6b65 743d 4e6f 6e65 2c20  e, bucket=None, 
+000044a0: 6465 6275 673d 4661 6c73 652c 2065 6e63  debug=False, enc
+000044b0: 7279 7074 696f 6e3d 4661 6c73 6529 3a0a  ryption=False):.
+000044c0: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+000044d0: 7373 696f 6e20 3d20 626f 746f 332e 5365  ssion = boto3.Se
+000044e0: 7373 696f 6e28 7072 6f66 696c 655f 6e61  ssion(profile_na
+000044f0: 6d65 3d70 726f 6669 6c65 2c20 7265 6769  me=profile, regi
+00004500: 6f6e 5f6e 616d 653d 7265 6769 6f6e 290a  on_name=region).
+00004510: 2020 2020 2020 2020 7365 6c66 2e61 7468          self.ath
+00004520: 656e 6120 3d20 7365 6c66 2e73 6573 7369  ena = self.sessi
+00004530: 6f6e 2e63 6c69 656e 7428 2761 7468 656e  on.client('athen
+00004540: 6127 290a 0a20 2020 2020 2020 2073 656c  a')..        sel
+00004550: 662e 7265 6769 6f6e 203d 2072 6567 696f  f.region = regio
+00004560: 6e20 6f72 206f 732e 656e 7669 726f 6e2e  n or os.environ.
+00004570: 6765 7428 2741 5753 5f44 4546 4155 4c54  get('AWS_DEFAULT
+00004580: 5f52 4547 494f 4e27 2c20 4e6f 6e65 2920  _REGION', None) 
+00004590: 6f72 2073 656c 662e 7365 7373 696f 6e2e  or self.session.
+000045a0: 7265 6769 6f6e 5f6e 616d 650a 0a20 2020  region_name..   
+000045b0: 2020 2020 2073 656c 662e 6275 636b 6574       self.bucket
+000045c0: 203d 2062 7563 6b65 7420 6f72 2073 656c   = bucket or sel
+000045d0: 662e 6465 6661 756c 745f 6275 636b 6574  f.default_bucket
+000045e0: 0a20 2020 2020 2020 2073 656c 662e 6465  .        self.de
+000045f0: 6275 6720 3d20 6465 6275 670a 2020 2020  bug = debug.    
+00004600: 2020 2020 7365 6c66 2e65 6e63 7279 7074      self.encrypt
+00004610: 696f 6e20 3d20 656e 6372 7970 7469 6f6e  ion = encryption
+00004620: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00004630: 2020 2020 6465 6620 6465 6661 756c 745f      def default_
+00004640: 6275 636b 6574 2873 656c 6629 3a0a 2020  bucket(self):.  
+00004650: 2020 2020 2020 6163 636f 756e 745f 6964        account_id
+00004660: 203d 2073 656c 662e 7365 7373 696f 6e2e   = self.session.
+00004670: 636c 6965 6e74 2827 7374 7327 292e 6765  client('sts').ge
+00004680: 745f 6361 6c6c 6572 5f69 6465 6e74 6974  t_caller_identit
+00004690: 7928 292e 6765 7428 2741 6363 6f75 6e74  y().get('Account
+000046a0: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
+000046b0: 6e20 2773 333a 2f2f 7b7d 2d71 7565 7279  n 's3://{}-query
+000046c0: 2d72 6573 756c 7473 2d7b 7d2d 7b7d 272e  -results-{}-{}'.
+000046d0: 666f 726d 6174 2873 656c 662e 7365 7373  format(self.sess
+000046e0: 696f 6e2e 7072 6f66 696c 655f 6e61 6d65  ion.profile_name
+000046f0: 206f 7220 2761 7773 2d61 7468 656e 6127   or 'aws-athena'
+00004700: 2c20 6163 636f 756e 745f 6964 2c20 7365  , account_id, se
+00004710: 6c66 2e72 6567 696f 6e29 0a0a 2020 2020  lf.region)..    
+00004720: 6465 6620 7374 6172 745f 7175 6572 795f  def start_query_
+00004730: 6578 6563 7574 696f 6e28 7365 6c66 2c20  execution(self, 
+00004740: 6462 2c20 7175 6572 7929 3a0a 2020 2020  db, query):.    
+00004750: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00004760: 2020 2020 2069 6620 6e6f 7420 6462 3a0a       if not db:.
+00004770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004780: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00004790: 2827 5363 6865 6d61 206d 7573 7420 6265  ('Schema must be
+000047a0: 2073 7065 6369 6669 6564 2077 6865 6e20   specified when 
+000047b0: 7365 7373 696f 6e20 7363 6865 6d61 2069  session schema i
+000047c0: 7320 6e6f 7420 7365 7427 290a 0a20 2020  s not set')..   
+000047d0: 2020 2020 2020 2020 2072 6573 756c 745f           result_
+000047e0: 636f 6e66 6967 7572 6174 696f 6e20 3d20  configuration = 
+000047f0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00004800: 2020 274f 7574 7075 744c 6f63 6174 696f    'OutputLocatio
+00004810: 6e27 3a20 7365 6c66 2e62 7563 6b65 742c  n': self.bucket,
+00004820: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+00004830: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00004840: 6c66 2e65 6e63 7279 7074 696f 6e3a 0a20  lf.encryption:. 
+00004850: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00004860: 6573 756c 745f 636f 6e66 6967 7572 6174  esult_configurat
+00004870: 696f 6e5b 2745 6e63 7279 7074 696f 6e43  ion['EncryptionC
+00004880: 6f6e 6669 6775 7261 7469 6f6e 275d 203d  onfiguration'] =
+00004890: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000048a0: 2020 2020 2020 2027 456e 6372 7970 7469         'Encrypti
+000048b0: 6f6e 4f70 7469 6f6e 273a 2027 5353 455f  onOption': 'SSE_
+000048c0: 5333 270a 2020 2020 2020 2020 2020 2020  S3'.            
+000048d0: 2020 2020 7d0a 0a20 2020 2020 2020 2020      }..         
+000048e0: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
+000048f0: 7468 656e 612e 7374 6172 745f 7175 6572  thena.start_quer
+00004900: 795f 6578 6563 7574 696f 6e28 0a20 2020  y_execution(.   
+00004910: 2020 2020 2020 2020 2020 2020 2051 7565               Que
+00004920: 7279 5374 7269 6e67 3d71 7565 7279 2c0a  ryString=query,.
+00004930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004940: 436c 6965 6e74 5265 7175 6573 7454 6f6b  ClientRequestTok
+00004950: 656e 3d73 7472 2875 7569 642e 7575 6964  en=str(uuid.uuid
+00004960: 3428 2929 2c0a 2020 2020 2020 2020 2020  4()),.          
+00004970: 2020 2020 2020 5175 6572 7945 7865 6375        QueryExecu
+00004980: 7469 6f6e 436f 6e74 6578 743d 7b0a 2020  tionContext={.  
+00004990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049a0: 2020 2744 6174 6162 6173 6527 3a20 6462    'Database': db
+000049b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000049c0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+000049d0: 2020 2020 5265 7375 6c74 436f 6e66 6967      ResultConfig
+000049e0: 7572 6174 696f 6e3d 7265 7375 6c74 5f63  uration=result_c
+000049f0: 6f6e 6669 6775 7261 7469 6f6e 0a20 2020  onfiguration.   
+00004a00: 2020 2020 2020 2020 2029 5b27 5175 6572           )['Quer
+00004a10: 7945 7865 6375 7469 6f6e 4964 275d 0a20  yExecutionId']. 
+00004a20: 2020 2020 2020 2065 7863 6570 7420 2843         except (C
+00004a30: 6c69 656e 7445 7272 6f72 2c20 5061 7261  lientError, Para
+00004a40: 6d56 616c 6964 6174 696f 6e45 7272 6f72  mValidationError
+00004a50: 2c20 5661 6c75 6545 7272 6f72 2920 6173  , ValueError) as
+00004a60: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
+00004a70: 7072 696e 7428 6529 0a20 2020 2020 2020  print(e).       
+00004a80: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+00004a90: 2064 6566 2067 6574 5f71 7565 7279 5f65   def get_query_e
+00004aa0: 7865 6375 7469 6f6e 2873 656c 662c 2065  xecution(self, e
+00004ab0: 7865 6375 7469 6f6e 5f69 6429 3a0a 2020  xecution_id):.  
+00004ac0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00004ad0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00004ae0: 6c66 2e61 7468 656e 612e 6765 745f 7175  lf.athena.get_qu
+00004af0: 6572 795f 6578 6563 7574 696f 6e28 0a20  ery_execution(. 
+00004b00: 2020 2020 2020 2020 2020 2020 2020 2051                 Q
+00004b10: 7565 7279 4578 6563 7574 696f 6e49 643d  ueryExecutionId=
+00004b20: 6578 6563 7574 696f 6e5f 6964 0a20 2020  execution_id.   
+00004b30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00004b40: 2020 2065 7863 6570 7420 436c 6965 6e74     except Client
+00004b50: 4572 726f 7220 6173 2065 3a0a 2020 2020  Error as e:.    
+00004b60: 2020 2020 2020 2020 7072 696e 7428 6529          print(e)
+00004b70: 0a0a 2020 2020 6465 6620 6765 745f 7175  ..    def get_qu
+00004b80: 6572 795f 7265 7375 6c74 7328 7365 6c66  ery_results(self
+00004b90: 2c20 6578 6563 7574 696f 6e5f 6964 293a  , execution_id):
+00004ba0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00004bb0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00004bc0: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
+00004bd0: 2020 2020 2070 6167 696e 6174 6f72 203d       paginator =
+00004be0: 2073 656c 662e 6174 6865 6e61 2e67 6574   self.athena.get
+00004bf0: 5f70 6167 696e 6174 6f72 2827 6765 745f  _paginator('get_
+00004c00: 7175 6572 795f 7265 7375 6c74 7327 290a  query_results').
+00004c10: 2020 2020 2020 2020 2020 2020 7061 6765              page
+00004c20: 5f69 7465 7261 746f 7220 3d20 7061 6769  _iterator = pagi
+00004c30: 6e61 746f 722e 7061 6769 6e61 7465 280a  nator.paginate(.
+00004c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c50: 5175 6572 7945 7865 6375 7469 6f6e 4964  QueryExecutionId
+00004c60: 3d65 7865 6375 7469 6f6e 5f69 640a 2020  =execution_id.  
+00004c70: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00004c80: 2020 2020 2020 2020 2066 6f72 2070 6167           for pag
+00004c90: 6520 696e 2070 6167 655f 6974 6572 6174  e in page_iterat
+00004ca0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00004cb0: 2020 2020 6966 2072 6573 756c 7473 2069      if results i
+00004cc0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00004cd0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00004ce0: 6c74 7320 3d20 7061 6765 0a20 2020 2020  lts = page.     
+00004cf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00004d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004d10: 2020 2020 2072 6573 756c 7473 5b27 5265       results['Re
+00004d20: 7375 6c74 5365 7427 5d5b 2752 6f77 7327  sultSet']['Rows'
+00004d30: 5d2e 6578 7465 6e64 2870 6167 655b 2752  ].extend(page['R
+00004d40: 6573 756c 7453 6574 275d 5b27 526f 7773  esultSet']['Rows
+00004d50: 275d 290a 2020 2020 2020 2020 6578 6365  ']).        exce
+00004d60: 7074 2043 6c69 656e 7445 7272 6f72 2061  pt ClientError a
+00004d70: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
+00004d80: 2073 7973 2e65 7869 7428 6529 0a0a 2020   sys.exit(e)..  
+00004d90: 2020 2020 2020 6966 2073 656c 662e 6465        if self.de
+00004da0: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
+00004db0: 2070 7269 6e74 286a 736f 6e2e 6475 6d70   print(json.dump
+00004dc0: 7328 7265 7375 6c74 732c 2069 6e64 656e  s(results, inden
+00004dd0: 743d 3229 290a 0a20 2020 2020 2020 2072  t=2))..        r
+00004de0: 6574 7572 6e20 7265 7375 6c74 730a 0a20  eturn results.. 
+00004df0: 2020 2064 6566 2073 746f 705f 7175 6572     def stop_quer
+00004e00: 795f 6578 6563 7574 696f 6e28 7365 6c66  y_execution(self
+00004e10: 2c20 6578 6563 7574 696f 6e5f 6964 293a  , execution_id):
+00004e20: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00004e30: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004e40: 2073 656c 662e 6174 6865 6e61 2e73 746f   self.athena.sto
+00004e50: 705f 7175 6572 795f 6578 6563 7574 696f  p_query_executio
+00004e60: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00004e70: 2020 2051 7565 7279 4578 6563 7574 696f     QueryExecutio
+00004e80: 6e49 643d 6578 6563 7574 696f 6e5f 6964  nId=execution_id
+00004e90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00004ea0: 2020 2020 2020 2065 7863 6570 7420 436c         except Cl
+00004eb0: 6965 6e74 4572 726f 7220 6173 2065 3a0a  ientError as e:.
+00004ec0: 2020 2020 2020 2020 2020 2020 7379 732e              sys.
+00004ed0: 6578 6974 2865 290a 0a20 2020 2040 7374  exit(e)..    @st
+00004ee0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+00004ef0: 6566 2079 6965 6c64 5f72 6f77 7328 7265  ef yield_rows(re
+00004f00: 7375 6c74 732c 2068 6561 6465 7273 293a  sults, headers):
+00004f10: 0a20 2020 2020 2020 2066 6f72 2072 6f77  .        for row
+00004f20: 2069 6e20 7265 7375 6c74 735b 2752 6573   in results['Res
+00004f30: 756c 7453 6574 275d 5b27 526f 7773 275d  ultSet']['Rows']
+00004f40: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00004f50: 6874 7470 733a 2f2f 666f 7275 6d73 2e61  https://forums.a
+00004f60: 7773 2e61 6d61 7a6f 6e2e 636f 6d2f 7468  ws.amazon.com/th
+00004f70: 7265 6164 2e6a 7370 613f 7468 7265 6164  read.jspa?thread
+00004f80: 4944 3d32 3536 3530 350a 2020 2020 2020  ID=256505.      
+00004f90: 2020 2020 2020 6966 2068 6561 6465 7273        if headers
+00004fa0: 2061 6e64 2072 6f77 5b27 4461 7461 275d   and row['Data']
+00004fb0: 5b30 5d2e 6765 7428 2756 6172 4368 6172  [0].get('VarChar
+00004fc0: 5661 6c75 6527 2c20 4e6f 6e65 2920 3d3d  Value', None) ==
+00004fd0: 2068 6561 6465 7273 5b30 5d3a 0a20 2020   headers[0]:.   
+00004fe0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00004ff0: 7469 6e75 6520 2023 2073 6b69 7020 6865  tinue  # skip he
+00005000: 6164 6572 0a20 2020 2020 2020 2020 2020  ader.           
+00005010: 2079 6965 6c64 205b 642e 6765 7428 2756   yield [d.get('V
+00005020: 6172 4368 6172 5661 6c75 6527 2c20 274e  arCharValue', 'N
+00005030: 554c 4c27 2920 666f 7220 6420 696e 2072  ULL') for d in r
+00005040: 6f77 5b27 4461 7461 275d 5d0a 0a20 2020  ow['Data']]..   
+00005050: 2064 6566 2063 6f6e 736f 6c65 5f6c 696e   def console_lin
+00005060: 6b28 7365 6c66 2c20 6578 6563 7574 696f  k(self, executio
+00005070: 6e5f 6964 293a 0a20 2020 2020 2020 2072  n_id):.        r
+00005080: 6574 7572 6e20 2768 7474 7073 3a2f 2f7b  eturn 'https://{
+00005090: 307d 2e63 6f6e 736f 6c65 2e61 7773 2e61  0}.console.aws.a
+000050a0: 6d61 7a6f 6e2e 636f 6d2f 6174 6865 6e61  mazon.com/athena
+000050b0: 2f68 6f6d 653f 666f 7263 6526 7265 6769  /home?force&regi
+000050c0: 6f6e 3d7b 307d 2371 7565 7279 2f68 6973  on={0}#query/his
+000050d0: 746f 7279 2f7b 317d 272e 666f 726d 6174  tory/{1}'.format
+000050e0: 2873 656c 662e 7265 6769 6f6e 2c20 6578  (self.region, ex
+000050f0: 6563 7574 696f 6e5f 6964 290a 0a0a 6465  ecution_id)...de
+00005100: 6620 6875 6d61 6e5f 7265 6164 6162 6c65  f human_readable
+00005110: 2873 697a 652c 2070 7265 6369 7369 6f6e  (size, precision
+00005120: 3d32 293a 0a20 2020 2073 7566 6669 7865  =2):.    suffixe
+00005130: 7320 3d20 5b27 4227 2c20 274b 4227 2c20  s = ['B', 'KB', 
+00005140: 274d 4227 2c20 2747 4227 2c20 2754 4227  'MB', 'GB', 'TB'
+00005150: 5d0a 2020 2020 7375 6666 6978 496e 6465  ].    suffixInde
+00005160: 7820 3d20 300a 2020 2020 7768 696c 6520  x = 0.    while 
+00005170: 7369 7a65 203e 2031 3032 3420 616e 6420  size > 1024 and 
+00005180: 7375 6666 6978 496e 6465 7820 3c20 343a  suffixIndex < 4:
+00005190: 0a20 2020 2020 2020 2073 7566 6669 7849  .        suffixI
+000051a0: 6e64 6578 202b 3d20 3120 2369 6e63 7265  ndex += 1 #incre
+000051b0: 6d65 6e74 2074 6865 2069 6e64 6578 206f  ment the index o
+000051c0: 6620 7468 6520 7375 6666 6978 0a20 2020  f the suffix.   
+000051d0: 2020 2020 2073 697a 6520 3d20 7369 7a65       size = size
+000051e0: 2f31 3032 342e 3020 2361 7070 6c79 2074  /1024.0 #apply t
+000051f0: 6865 2064 6976 6973 696f 6e0a 2020 2020  he division.    
+00005200: 7265 7475 726e 2022 252e 2a66 2573 2225  return "%.*f%s"%
+00005210: 2870 7265 6369 7369 6f6e 2c20 7369 7a65  (precision, size
+00005220: 2c20 7375 6666 6978 6573 5b73 7566 6669  , suffixes[suffi
+00005230: 7849 6e64 6578 5d29 0a0a 0a64 6566 206d  xIndex])...def m
+00005240: 6169 6e28 293a 0a0a 2020 2020 7061 7273  ain():..    pars
+00005250: 6572 203d 2061 7267 7061 7273 652e 4172  er = argparse.Ar
+00005260: 6775 6d65 6e74 5061 7273 6572 280a 2020  gumentParser(.  
+00005270: 2020 2020 2020 7072 6f67 3d27 6174 6865        prog='athe
+00005280: 6e61 272c 0a20 2020 2020 2020 2075 7361  na',.        usa
+00005290: 6765 3d27 6174 6865 6e61 205b 2d2d 6465  ge='athena [--de
+000052a0: 6275 675d 205b 2d2d 6578 6563 7574 6520  bug] [--execute 
+000052b0: 3c73 7461 7465 6d65 6e74 3e5d 205b 2d2d  <statement>] [--
+000052c0: 6f75 7470 7574 2d66 6f72 6d61 7420 3c66  output-format <f
+000052d0: 6f72 6d61 743e 5d20 5b2d 2d73 6368 656d  ormat>] [--schem
+000052e0: 6120 3c73 6368 656d 613e 5d27 0a20 2020  a <schema>]'.   
+000052f0: 2020 2020 2020 2020 2020 2027 205b 2d2d             ' [--
+00005300: 7072 6f66 696c 6520 3c70 726f 6669 6c65  profile <profile
+00005310: 3e5d 205b 2d2d 7265 6769 6f6e 203c 7265  >] [--region <re
+00005320: 6769 6f6e 3e5d 205b 2d2d 7333 2d62 7563  gion>] [--s3-buc
+00005330: 6b65 7420 3c62 7563 6b65 743e 5d20 5b2d  ket <bucket>] [-
+00005340: 2d73 6572 7665 722d 7369 6465 2d65 6e63  -server-side-enc
+00005350: 7279 7074 696f 6e5d 205b 2d2d 7665 7273  ryption] [--vers
+00005360: 696f 6e5d 272c 0a20 2020 2020 2020 2064  ion]',.        d
+00005370: 6573 6372 6970 7469 6f6e 3d27 4174 6865  escription='Athe
+00005380: 6e61 2069 6e74 6572 6163 7469 7665 2063  na interactive c
+00005390: 6f6e 736f 6c65 270a 2020 2020 290a 2020  onsole'.    ).  
+000053a0: 2020 7061 7273 6572 2e61 6464 5f61 7267    parser.add_arg
+000053b0: 756d 656e 7428 0a20 2020 2020 2020 2027  ument(.        '
+000053c0: 2d2d 6465 6275 6727 2c0a 2020 2020 2020  --debug',.      
+000053d0: 2020 6163 7469 6f6e 3d27 7374 6f72 655f    action='store_
+000053e0: 7472 7565 272c 0a20 2020 2020 2020 2068  true',.        h
+000053f0: 656c 703d 2765 6e61 626c 6520 6465 6275  elp='enable debu
+00005400: 6720 6d6f 6465 270a 2020 2020 290a 2020  g mode'.    ).  
+00005410: 2020 7061 7273 6572 2e61 6464 5f61 7267    parser.add_arg
+00005420: 756d 656e 7428 0a20 2020 2020 2020 2027  ument(.        '
+00005430: 2d2d 6578 6563 7574 6527 2c0a 2020 2020  --execute',.    
+00005440: 2020 2020 6d65 7461 7661 723d 2753 5441      metavar='STA
+00005450: 5445 4d45 4e54 272c 0a20 2020 2020 2020  TEMENT',.       
+00005460: 2068 656c 703d 2765 7865 6375 7465 2073   help='execute s
+00005470: 7461 7465 6d65 6e74 2069 6e20 6261 7463  tatement in batc
+00005480: 6820 6d6f 6465 270a 2020 2020 290a 2020  h mode'.    ).  
+00005490: 2020 7061 7273 6572 2e61 6464 5f61 7267    parser.add_arg
+000054a0: 756d 656e 7428 0a20 2020 2020 2020 2027  ument(.        '
+000054b0: 2d2d 6f75 7470 7574 2d66 6f72 6d61 7427  --output-format'
+000054c0: 2c0a 2020 2020 2020 2020 6368 6f69 6365  ,.        choice
+000054d0: 733d 2827 414c 4947 4e45 4427 2c20 2756  s=('ALIGNED', 'V
+000054e0: 4552 5449 4341 4c27 2c20 2743 5356 272c  ERTICAL', 'CSV',
+000054f0: 2027 5453 5627 2c20 2743 5356 5f48 4541   'TSV', 'CSV_HEA
+00005500: 4445 5227 2c20 2754 5356 5f48 4541 4445  DER', 'TSV_HEADE
+00005510: 5227 2c20 274e 554c 4c27 292c 0a20 2020  R', 'NULL'),.   
+00005520: 2020 2020 2064 6573 743d 2766 6f72 6d61       dest='forma
+00005530: 7427 2c0a 2020 2020 2020 2020 6865 6c70  t',.        help
+00005540: 3d27 6f75 7470 7574 2066 6f72 6d61 7420  ='output format 
+00005550: 666f 7220 6261 7463 6820 6d6f 6465 270a  for batch mode'.
+00005560: 2020 2020 290a 2020 2020 7061 7273 6572      ).    parser
+00005570: 2e61 6464 5f61 7267 756d 656e 7428 0a20  .add_argument(. 
+00005580: 2020 2020 2020 2027 2d2d 7363 6865 6d61         '--schema
+00005590: 272c 0a20 2020 2020 2020 2027 2d2d 6461  ',.        '--da
+000055a0: 7461 6261 7365 272c 0a20 2020 2020 2020  tabase',.       
+000055b0: 2027 2d2d 6462 272c 0a20 2020 2020 2020   '--db',.       
+000055c0: 2068 656c 703d 2764 6566 6175 6c74 2073   help='default s
+000055d0: 6368 656d 6127 0a20 2020 2029 0a20 2020  chema'.    ).   
+000055e0: 2070 6172 7365 722e 6164 645f 6172 6775   parser.add_argu
+000055f0: 6d65 6e74 280a 2020 2020 2020 2020 272d  ment(.        '-
+00005600: 2d70 726f 6669 6c65 272c 0a20 2020 2020  -profile',.     
+00005610: 2020 2068 656c 703d 2741 5753 2070 726f     help='AWS pro
+00005620: 6669 6c65 270a 2020 2020 290a 2020 2020  file'.    ).    
+00005630: 7061 7273 6572 2e61 6464 5f61 7267 756d  parser.add_argum
+00005640: 656e 7428 0a20 2020 2020 2020 2027 2d2d  ent(.        '--
+00005650: 7265 6769 6f6e 272c 0a20 2020 2020 2020  region',.       
+00005660: 2068 656c 703d 2741 5753 2072 6567 696f   help='AWS regio
+00005670: 6e27 0a20 2020 2029 0a20 2020 2070 6172  n'.    ).    par
+00005680: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+00005690: 280a 2020 2020 2020 2020 272d 2d73 332d  (.        '--s3-
+000056a0: 6275 636b 6574 272c 0a20 2020 2020 2020  bucket',.       
+000056b0: 2027 2d2d 6275 636b 6574 272c 0a20 2020   '--bucket',.   
+000056c0: 2020 2020 2064 6573 743d 2762 7563 6b65       dest='bucke
+000056d0: 7427 2c0a 2020 2020 2020 2020 6865 6c70  t',.        help
+000056e0: 3d27 4157 5320 5333 2062 7563 6b65 7420  ='AWS S3 bucket 
+000056f0: 666f 7220 7175 6572 7920 7265 7375 6c74  for query result
+00005700: 7327 0a20 2020 2029 0a20 2020 2070 6172  s'.    ).    par
+00005710: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+00005720: 280a 2020 2020 2020 2020 272d 2d73 6572  (.        '--ser
+00005730: 7665 722d 7369 6465 2d65 6e63 7279 7074  ver-side-encrypt
+00005740: 696f 6e27 2c0a 2020 2020 2020 2020 272d  ion',.        '-
+00005750: 2d65 6e63 7279 7074 696f 6e27 2c0a 2020  -encryption',.  
+00005760: 2020 2020 2020 6465 7374 3d27 656e 6372        dest='encr
+00005770: 7970 7469 6f6e 272c 0a20 2020 2020 2020  yption',.       
+00005780: 2061 6374 696f 6e3d 2773 746f 7265 5f74   action='store_t
+00005790: 7275 6527 2c0a 2020 2020 2020 2020 6865  rue',.        he
+000057a0: 6c70 3d27 5573 6520 7365 7276 6572 2d73  lp='Use server-s
+000057b0: 6964 652d 656e 6372 7970 7469 6f6e 2066  ide-encryption f
+000057c0: 6f72 2071 7565 7279 2072 6573 756c 7473  or query results
+000057d0: 270a 2020 2020 290a 2020 2020 7061 7273  '.    ).    pars
+000057e0: 6572 2e61 6464 5f61 7267 756d 656e 7428  er.add_argument(
+000057f0: 0a20 2020 2020 2020 2027 2d2d 7665 7273  .        '--vers
+00005800: 696f 6e27 2c0a 2020 2020 2020 2020 6163  ion',.        ac
+00005810: 7469 6f6e 3d27 7374 6f72 655f 7472 7565  tion='store_true
+00005820: 272c 0a20 2020 2020 2020 2068 656c 703d  ',.        help=
+00005830: 2773 686f 7720 7665 7273 696f 6e20 696e  'show version in
+00005840: 666f 2061 6e64 2065 7869 7427 0a20 2020  fo and exit'.   
+00005850: 2029 0a20 2020 2061 7267 7320 3d20 7061   ).    args = pa
+00005860: 7273 6572 2e70 6172 7365 5f61 7267 7328  rser.parse_args(
+00005870: 290a 0a20 2020 2069 6620 6172 6773 2e64  )..    if args.d
+00005880: 6562 7567 3a0a 2020 2020 2020 2020 626f  ebug:.        bo
+00005890: 746f 332e 7365 745f 7374 7265 616d 5f6c  to3.set_stream_l
+000058a0: 6f67 6765 7228 6e61 6d65 3d27 626f 746f  ogger(name='boto
+000058b0: 636f 7265 2729 0a0a 2020 2020 6966 2061  core')..    if a
+000058c0: 7267 732e 7665 7273 696f 6e3a 0a20 2020  rgs.version:.   
+000058d0: 2020 2020 2070 7269 6e74 2827 4174 6865       print('Athe
+000058e0: 6e61 2043 4c49 2025 7327 2025 205f 5f76  na CLI %s' % __v
+000058f0: 6572 7369 6f6e 5f5f 290a 2020 2020 2020  ersion__).      
+00005900: 2020 7379 732e 6578 6974 2829 0a0a 2020    sys.exit()..  
+00005910: 2020 7072 6f66 696c 6520 3d20 6172 6773    profile = args
+00005920: 2e70 726f 6669 6c65 206f 7220 6f73 2e65  .profile or os.e
+00005930: 6e76 6972 6f6e 2e67 6574 2827 4157 535f  nviron.get('AWS_
+00005940: 4445 4641 554c 545f 5052 4f46 494c 4527  DEFAULT_PROFILE'
+00005950: 2c20 4e6f 6e65 2920 6f72 206f 732e 656e  , None) or os.en
+00005960: 7669 726f 6e2e 6765 7428 2741 5753 5f50  viron.get('AWS_P
+00005970: 524f 4649 4c45 272c 204e 6f6e 6529 0a0a  ROFILE', None)..
+00005980: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00005990: 2061 7468 656e 6120 3d20 4174 6865 6e61   athena = Athena
+000059a0: 2870 726f 6669 6c65 2c20 7265 6769 6f6e  (profile, region
+000059b0: 3d61 7267 732e 7265 6769 6f6e 2c20 6275  =args.region, bu
+000059c0: 636b 6574 3d61 7267 732e 6275 636b 6574  cket=args.bucket
+000059d0: 2c20 6465 6275 673d 6172 6773 2e64 6562  , debug=args.deb
+000059e0: 7567 2c20 656e 6372 7970 7469 6f6e 3d61  ug, encryption=a
+000059f0: 7267 732e 656e 6372 7970 7469 6f6e 290a  rgs.encryption).
+00005a00: 2020 2020 6578 6365 7074 2062 6f74 6f63      except botoc
+00005a10: 6f72 652e 6578 6365 7074 696f 6e73 2e43  ore.exceptions.C
+00005a20: 6c69 656e 7445 7272 6f72 2061 7320 653a  lientError as e:
+00005a30: 0a20 2020 2020 2020 2073 7973 2e65 7869  .        sys.exi
+00005a40: 7428 6529 0a0a 2020 2020 6966 2061 7267  t(e)..    if arg
+00005a50: 732e 6578 6563 7574 653a 0a20 2020 2020  s.execute:.     
+00005a60: 2020 2062 6174 6368 203d 2041 7468 656e     batch = Athen
+00005a70: 6142 6174 6368 2861 7468 656e 612c 2064  aBatch(athena, d
+00005a80: 623d 6172 6773 2e73 6368 656d 612c 2066  b=args.schema, f
+00005a90: 6f72 6d61 743d 6172 6773 2e66 6f72 6d61  ormat=args.forma
+00005aa0: 7429 0a20 2020 2020 2020 2062 6174 6368  t).        batch
+00005ab0: 2e65 7865 6375 7465 2873 7461 7465 6d65  .execute(stateme
+00005ac0: 6e74 3d61 7267 732e 6578 6563 7574 6529  nt=args.execute)
+00005ad0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00005ae0: 2020 2073 6865 6c6c 203d 2041 7468 656e     shell = Athen
+00005af0: 6153 6865 6c6c 2861 7468 656e 612c 2064  aShell(athena, d
+00005b00: 623d 6172 6773 2e73 6368 656d 6129 0a20  b=args.schema). 
+00005b10: 2020 2020 2020 2073 6865 6c6c 2e63 6d64         shell.cmd
+00005b20: 6c6f 6f70 5f77 6974 685f 6361 6e63 656c  loop_with_cancel
+00005b30: 2829 0a0a 6966 205f 5f6e 616d 655f 5f20  ()..if __name__ 
+00005b40: 3d3d 2027 5f5f 6d61 696e 5f5f 273a 0a20  == '__main__':. 
+00005b50: 2020 206d 6169 6e28 290a 0000 0000 0000     main().......
+00005b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005c00: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00005c00: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00005c10: 2f52 4541 444d 452e 6d64 0000 0000 0000  /README.md......
 00005c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00005c70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00005c80: 3030 3130 3630 3700 3133 3234 3032 3630  0010607.13240260
-00005c90: 3032 3500 3031 3537 3631 0020 3000 0000  025.015761. 0...
+00005c80: 3030 3130 3635 3000 3133 3436 3532 3636  0010650.13465266
+00005c90: 3032 3000 3031 3537 3732 0020 3000 0000  020.015772. 0...
 00005ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005d00: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -1743,67 +1743,67 @@
 00006ce0: 6f44 423a 2068 7474 7073 3a2f 2f70 7265  oDB: https://pre
 00006cf0: 7374 6f64 622e 696f 2f64 6f63 732f 6375  stodb.io/docs/cu
 00006d00: 7272 656e 742f 0a0a 4c69 6365 6e73 650a  rrent/..License.
 00006d10: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2041 7468  -------..    Ath
 00006d20: 656e 6120 434c 490a 2020 2020 436f 7079  ena CLI.    Copy
 00006d30: 7269 6768 7420 3230 3137 2d32 3031 3820  right 2017-2018 
 00006d40: 4775 6172 6469 616e 204e 6577 7320 2620  Guardian News & 
-00006d50: 4d65 6469 610a 0a20 2020 204c 6963 656e  Media..    Licen
-00006d60: 7365 6420 756e 6465 7220 7468 6520 4170  sed under the Ap
-00006d70: 6163 6865 204c 6963 656e 7365 2c20 5665  ache License, Ve
-00006d80: 7273 696f 6e20 322e 3020 2874 6865 2022  rsion 2.0 (the "
-00006d90: 4c69 6365 6e73 6522 293b 0a20 2020 2079  License");.    y
-00006da0: 6f75 206d 6179 206e 6f74 2075 7365 2074  ou may not use t
-00006db0: 6869 7320 6669 6c65 2065 7863 6570 7420  his file except 
-00006dc0: 696e 2063 6f6d 706c 6961 6e63 6520 7769  in compliance wi
-00006dd0: 7468 2074 6865 204c 6963 656e 7365 2e0a  th the License..
-00006de0: 2020 2020 596f 7520 6d61 7920 6f62 7461      You may obta
-00006df0: 696e 2061 2063 6f70 7920 6f66 2074 6865  in a copy of the
-00006e00: 204c 6963 656e 7365 2061 740a 0a20 2020   License at..   
-00006e10: 2020 2020 2068 7474 703a 2f2f 7777 772e       http://www.
-00006e20: 6170 6163 6865 2e6f 7267 2f6c 6963 656e  apache.org/licen
-00006e30: 7365 732f 4c49 4345 4e53 452d 322e 300a  ses/LICENSE-2.0.
-00006e40: 0a20 2020 2055 6e6c 6573 7320 7265 7175  .    Unless requ
-00006e50: 6972 6564 2062 7920 6170 706c 6963 6162  ired by applicab
-00006e60: 6c65 206c 6177 206f 7220 6167 7265 6564  le law or agreed
-00006e70: 2074 6f20 696e 2077 7269 7469 6e67 2c20   to in writing, 
-00006e80: 736f 6674 7761 7265 0a20 2020 2064 6973  software.    dis
-00006e90: 7472 6962 7574 6564 2075 6e64 6572 2074  tributed under t
-00006ea0: 6865 204c 6963 656e 7365 2069 7320 6469  he License is di
-00006eb0: 7374 7269 6275 7465 6420 6f6e 2061 6e20  stributed on an 
-00006ec0: 2241 5320 4953 2220 4241 5349 532c 0a20  "AS IS" BASIS,. 
-00006ed0: 2020 2057 4954 484f 5554 2057 4152 5241     WITHOUT WARRA
-00006ee0: 4e54 4945 5320 4f52 2043 4f4e 4449 5449  NTIES OR CONDITI
-00006ef0: 4f4e 5320 4f46 2041 4e59 204b 494e 442c  ONS OF ANY KIND,
-00006f00: 2065 6974 6865 7220 6578 7072 6573 7320   either express 
-00006f10: 6f72 2069 6d70 6c69 6564 2e0a 2020 2020  or implied..    
-00006f20: 5365 6520 7468 6520 4c69 6365 6e73 6520  See the License 
-00006f30: 666f 7220 7468 6520 7370 6563 6966 6963  for the specific
-00006f40: 206c 616e 6775 6167 6520 676f 7665 726e   language govern
-00006f50: 696e 6720 7065 726d 6973 7369 6f6e 7320  ing permissions 
-00006f60: 616e 640a 2020 2020 6c69 6d69 7461 7469  and.    limitati
-00006f70: 6f6e 7320 756e 6465 7220 7468 6520 4c69  ons under the Li
-00006f80: 6365 6e73 652e 0a00 0000 0000 0000 0000  cense...........
-00006f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d50: 4d65 6469 610a 2020 2020 436f 7079 7269  Media.    Copyri
+00006d60: 6768 7420 3230 3139 204e 6963 6b20 5361  ght 2019 Nick Sa
+00006d70: 7474 6572 6c79 0a0a 2020 2020 4c69 6365  tterly..    Lice
+00006d80: 6e73 6564 2075 6e64 6572 2074 6865 2041  nsed under the A
+00006d90: 7061 6368 6520 4c69 6365 6e73 652c 2056  pache License, V
+00006da0: 6572 7369 6f6e 2032 2e30 2028 7468 6520  ersion 2.0 (the 
+00006db0: 224c 6963 656e 7365 2229 3b0a 2020 2020  "License");.    
+00006dc0: 796f 7520 6d61 7920 6e6f 7420 7573 6520  you may not use 
+00006dd0: 7468 6973 2066 696c 6520 6578 6365 7074  this file except
+00006de0: 2069 6e20 636f 6d70 6c69 616e 6365 2077   in compliance w
+00006df0: 6974 6820 7468 6520 4c69 6365 6e73 652e  ith the License.
+00006e00: 0a20 2020 2059 6f75 206d 6179 206f 6274  .    You may obt
+00006e10: 6169 6e20 6120 636f 7079 206f 6620 7468  ain a copy of th
+00006e20: 6520 4c69 6365 6e73 6520 6174 0a0a 2020  e License at..  
+00006e30: 2020 2020 2020 6874 7470 3a2f 2f77 7777        http://www
+00006e40: 2e61 7061 6368 652e 6f72 672f 6c69 6365  .apache.org/lice
+00006e50: 6e73 6573 2f4c 4943 454e 5345 2d32 2e30  nses/LICENSE-2.0
+00006e60: 0a0a 2020 2020 556e 6c65 7373 2072 6571  ..    Unless req
+00006e70: 7569 7265 6420 6279 2061 7070 6c69 6361  uired by applica
+00006e80: 626c 6520 6c61 7720 6f72 2061 6772 6565  ble law or agree
+00006e90: 6420 746f 2069 6e20 7772 6974 696e 672c  d to in writing,
+00006ea0: 2073 6f66 7477 6172 650a 2020 2020 6469   software.    di
+00006eb0: 7374 7269 6275 7465 6420 756e 6465 7220  stributed under 
+00006ec0: 7468 6520 4c69 6365 6e73 6520 6973 2064  the License is d
+00006ed0: 6973 7472 6962 7574 6564 206f 6e20 616e  istributed on an
+00006ee0: 2022 4153 2049 5322 2042 4153 4953 2c0a   "AS IS" BASIS,.
+00006ef0: 2020 2020 5749 5448 4f55 5420 5741 5252      WITHOUT WARR
+00006f00: 414e 5449 4553 204f 5220 434f 4e44 4954  ANTIES OR CONDIT
+00006f10: 494f 4e53 204f 4620 414e 5920 4b49 4e44  IONS OF ANY KIND
+00006f20: 2c20 6569 7468 6572 2065 7870 7265 7373  , either express
+00006f30: 206f 7220 696d 706c 6965 642e 0a20 2020   or implied..   
+00006f40: 2053 6565 2074 6865 204c 6963 656e 7365   See the License
+00006f50: 2066 6f72 2074 6865 2073 7065 6369 6669   for the specifi
+00006f60: 6320 6c61 6e67 7561 6765 2067 6f76 6572  c language gover
+00006f70: 6e69 6e67 2070 6572 6d69 7373 696f 6e73  ning permissions
+00006f80: 2061 6e64 0a20 2020 206c 696d 6974 6174   and.    limitat
+00006f90: 696f 6e73 2075 6e64 6572 2074 6865 204c  ions under the L
+00006fa0: 6963 656e 7365 2e0a 0000 0000 0000 0000  icense..........
 00006fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00007000: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00007010: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
 00007020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00007070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00007080: 3030 3031 3334 3300 3133 3234 3032 3630  0001343.13240260
-00007090: 3333 3100 3031 3632 3131 0020 3000 0000  331.016211. 0...
+00007080: 3030 3031 3431 3200 3133 3436 3533 3330  0001412.13465330
+00007090: 3235 3100 3031 3632 3137 0020 3000 0000  251.016217. 0...
 000070a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000070b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000070c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000070d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000070e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000070f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007100: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -1821,60 +1821,60 @@
 000071c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007200: 0a66 726f 6d20 7365 7475 7074 6f6f 6c73  .from setuptools
 00007210: 2069 6d70 6f72 7420 7365 7475 702c 2066   import setup, f
 00007220: 696e 645f 7061 636b 6167 6573 0a0a 7665  ind_packages..ve
-00007230: 7273 696f 6e20 3d20 2730 2e31 2e38 270a  rsion = '0.1.8'.
+00007230: 7273 696f 6e20 3d20 2730 2e31 2e39 270a  rsion = '0.1.9'.
 00007240: 0a73 6574 7570 280a 2020 2020 6e61 6d65  .setup(.    name
 00007250: 3d22 6174 6865 6e61 2d63 6c69 222c 0a20  ="athena-cli",. 
 00007260: 2020 2076 6572 7369 6f6e 3d76 6572 7369     version=versi
 00007270: 6f6e 2c0a 2020 2020 6465 7363 7269 7074  on,.    descript
 00007280: 696f 6e3d 2750 7265 7374 6f2d 6c69 6b65  ion='Presto-like
 00007290: 2043 4c49 2066 6f72 2041 5753 2041 7468   CLI for AWS Ath
 000072a0: 656e 6127 2c0a 2020 2020 7572 6c3d 2768  ena',.    url='h
 000072b0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000072c0: 6d2f 6775 6172 6469 616e 2f61 7468 656e  m/guardian/athen
+000072c0: 6d2f 7361 7474 6572 6c79 2f61 7468 656e  m/satterly/athen
 000072d0: 612d 636c 6927 2c0a 2020 2020 6c69 6365  a-cli',.    lice
 000072e0: 6e73 653d 2741 7061 6368 6520 4c69 6365  nse='Apache Lice
 000072f0: 6e73 6520 322e 3027 2c0a 2020 2020 6175  nse 2.0',.    au
 00007300: 7468 6f72 3d27 4e69 636b 2053 6174 7465  thor='Nick Satte
 00007310: 726c 7927 2c0a 2020 2020 6175 7468 6f72  rly',.    author
 00007320: 5f65 6d61 696c 3d27 6e69 636b 2e73 6174  _email='nick.sat
-00007330: 7465 726c 7940 7468 6567 7561 7264 6961  terly@theguardia
-00007340: 6e2e 636f 6d27 2c0a 2020 2020 7061 636b  n.com',.    pack
-00007350: 6167 6573 3d66 696e 645f 7061 636b 6167  ages=find_packag
-00007360: 6573 2829 2c0a 2020 2020 7079 5f6d 6f64  es(),.    py_mod
-00007370: 756c 6573 3d5b 0a20 2020 2020 2020 2027  ules=[.        '
-00007380: 6174 6865 6e61 5f63 6c69 270a 2020 2020  athena_cli'.    
-00007390: 5d2c 0a20 2020 2069 6e73 7461 6c6c 5f72  ],.    install_r
-000073a0: 6571 7569 7265 733d 5b0a 2020 2020 2020  equires=[.      
-000073b0: 2020 2762 6f74 6f33 272c 0a20 2020 2020    'boto3',.     
-000073c0: 2020 2027 636d 6432 272c 0a20 2020 2020     'cmd2',.     
-000073d0: 2020 2027 7461 6275 6c61 7465 3e3d 302e     'tabulate>=0.
-000073e0: 382e 3127 0a20 2020 205d 2c0a 2020 2020  8.1'.    ],.    
-000073f0: 696e 636c 7564 655f 7061 636b 6167 655f  include_package_
-00007400: 6461 7461 3d54 7275 652c 0a20 2020 207a  data=True,.    z
-00007410: 6970 5f73 6166 653d 5472 7565 2c0a 2020  ip_safe=True,.  
-00007420: 2020 656e 7472 795f 706f 696e 7473 3d7b    entry_points={
-00007430: 0a20 2020 2020 2020 2027 636f 6e73 6f6c  .        'consol
-00007440: 655f 7363 7269 7074 7327 3a20 5b0a 2020  e_scripts': [.  
-00007450: 2020 2020 2020 2020 2020 2761 7468 656e            'athen
-00007460: 6120 3d20 6174 6865 6e61 5f63 6c69 3a6d  a = athena_cli:m
-00007470: 6169 6e27 0a20 2020 2020 2020 205d 0a20  ain'.        ]. 
-00007480: 2020 207d 2c0a 2020 2020 6b65 7977 6f72     },.    keywor
-00007490: 6473 3d27 6177 7320 6174 6865 6e61 2070  ds='aws athena p
-000074a0: 7265 7374 6f20 636c 6927 2c0a 2020 2020  resto cli',.    
-000074b0: 636c 6173 7369 6669 6572 733d 5b0a 2020  classifiers=[.  
-000074c0: 2020 2020 2020 2754 6f70 6963 203a 3a20        'Topic :: 
-000074d0: 5574 696c 6974 6965 7327 0a20 2020 205d  Utilities'.    ]
-000074e0: 0a29 0a00 0000 0000 0000 0000 0000 0000  .)..............
-000074f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007330: 7465 726c 7940 676d 6169 6c2e 636f 6d27  terly@gmail.com'
+00007340: 2c0a 2020 2020 7061 636b 6167 6573 3d66  ,.    packages=f
+00007350: 696e 645f 7061 636b 6167 6573 2829 2c0a  ind_packages(),.
+00007360: 2020 2020 7079 5f6d 6f64 756c 6573 3d5b      py_modules=[
+00007370: 0a20 2020 2020 2020 2027 6174 6865 6e61  .        'athena
+00007380: 5f63 6c69 270a 2020 2020 5d2c 0a20 2020  _cli'.    ],.   
+00007390: 2069 6e73 7461 6c6c 5f72 6571 7569 7265   install_require
+000073a0: 733d 5b0a 2020 2020 2020 2020 2762 6f74  s=[.        'bot
+000073b0: 6f33 3e3d 312e 342e 3427 2c0a 2020 2020  o3>=1.4.4',.    
+000073c0: 2020 2020 2763 6d64 323e 3d30 2e39 2e30      'cmd2>=0.9.0
+000073d0: 2e31 272c 0a20 2020 2020 2020 2027 7461  .1',.        'ta
+000073e0: 6275 6c61 7465 3e3d 302e 382e 3127 0a20  bulate>=0.8.1'. 
+000073f0: 2020 205d 2c0a 2020 2020 696e 636c 7564     ],.    includ
+00007400: 655f 7061 636b 6167 655f 6461 7461 3d54  e_package_data=T
+00007410: 7275 652c 0a20 2020 207a 6970 5f73 6166  rue,.    zip_saf
+00007420: 653d 5472 7565 2c0a 2020 2020 656e 7472  e=True,.    entr
+00007430: 795f 706f 696e 7473 3d7b 0a20 2020 2020  y_points={.     
+00007440: 2020 2027 636f 6e73 6f6c 655f 7363 7269     'console_scri
+00007450: 7074 7327 3a20 5b0a 2020 2020 2020 2020  pts': [.        
+00007460: 2020 2020 2761 7468 656e 6120 3d20 6174      'athena = at
+00007470: 6865 6e61 5f63 6c69 3a6d 6169 6e27 0a20  hena_cli:main'. 
+00007480: 2020 2020 2020 205d 0a20 2020 207d 2c0a         ].    },.
+00007490: 2020 2020 6b65 7977 6f72 6473 3d27 6177      keywords='aw
+000074a0: 7320 6174 6865 6e61 2070 7265 7374 6f20  s athena presto 
+000074b0: 636c 6927 2c0a 2020 2020 636c 6173 7369  cli',.    classi
+000074c0: 6669 6572 733d 5b0a 2020 2020 2020 2020  fiers=[.        
+000074d0: 2754 6f70 6963 203a 3a20 5574 696c 6974  'Topic :: Utilit
+000074e0: 6965 7327 0a20 2020 205d 2c0a 2020 2020  ies'.    ],.    
+000074f0: 7079 7468 6f6e 5f72 6571 7569 7265 733d  python_requires=
+00007500: 273e 3d33 2e35 270a 290a 0000 0000 0000  '>=3.5'.).......
 00007510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1882,24 +1882,24 @@
 00007590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000075a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000075b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000075c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000075d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000075e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000075f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007600: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e38  athena-cli-0.1.8
+00007600: 6174 6865 6e61 2d63 6c69 2d30 2e31 2e39  athena-cli-0.1.9
 00007610: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
 00007620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00007670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00007680: 3030 3030 3132 3200 3133 3234 3032 3630  0000122.13240260
-00007690: 3531 3400 3031 3633 3135 0020 3000 0000  514.016315. 0...
+00007680: 3030 3030 3037 3500 3133 3436 3533 3330  0000075.13465330
+00007690: 3337 3700 3031 3633 3433 0020 3000 0000  377.016343. 0...
 000076a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007700: 0075 7374 6172 2020 006e 7361 7474 6572  .ustar  .nsatter
@@ -1917,17 +1917,17 @@
 000077c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007800: 5b77 6865 656c 5d0a 756e 6976 6572 7361  [wheel].universa
 00007810: 6c20 3d20 310a 0a5b 6567 675f 696e 666f  l = 1..[egg_info
 00007820: 5d0a 7461 675f 6275 696c 6420 3d20 0a74  ].tag_build = .t
-00007830: 6167 5f64 6174 6520 3d20 300a 7461 675f  ag_date = 0.tag_
-00007840: 7376 6e5f 7265 7669 7369 6f6e 203d 2030  svn_revision = 0
-00007850: 0a0a 0000 0000 0000 0000 0000 0000 0000  ................
+00007830: 6167 5f64 6174 6520 3d20 300a 0a00 0000  ag_date = 0.....
+00007840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000078a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000078b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000078c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

